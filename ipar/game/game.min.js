!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){g.style.display="block",f=new i(document.getElementById("board"),l.getScale(k.boardSize,new j(window.innerWidth,window.innerHeight))),e(Date.now())}function e(a){var b=Date.now()-a;f.update(b),window.requestAnimationFrame(e.bind(this,Date.now()))}document.documentElement.requestFullScreen=document.documentElement.requestFullScreen||document.documentElement.webkitRequestFullScreen||document.documentElement.mozRequestFullScreen;var f,g,h,i=a("./modules/game/game.js"),j=a("./modules/helper/point.js"),k=a("./modules/game/constants.js"),l=a("./modules/helper/utilities.js"),m=a("./modules/menus/titleMenu.js"),n=a("./modules/menus/caseMenu.js"),o=a("./modules/menus/profileMenu.js"),p=[],q=Object.freeze({TITLE:0,CASE:1,PROFILE:2,BOARD:3});window.onload=function(a){g=document.getElementById("board"),p[q.TITLE]=new m(document.getElementById("titleMenu")),p[q.TITLE].onclose=function(){switch(this.next){case m.NEXT.BOARD:h=q.BOARD,d();break;case m.NEXT.CASE:h=q.CASE,p[q.CASE].open()}},p[q.CASE]=new n(document.getElementById("caseMenu")),p[q.CASE].onclose=function(){switch(this.next){case n.NEXT.NEW_PROFILE:console.log("LOADING NEW PROFILE MENU"),h=q.PROFILE,p[q.PROFILE].open(!0);break;case n.NEXT.OLD_PROFILE:console.log("LOADING OLD PROFILE MENU"),h=q.PROFILE,p[q.PROFILE].open(!1);break;case n.NEXT.TITLE:h=q.TITLE,p[q.TITLE].open()}},p[q.PROFILE]=new o(document.getElementById("profileMenu")),p[q.PROFILE].onclose=function(){switch(this.next){case o.NEXT.BOARD:h=q.BOARD,d();break;case o.NEXT.CASE:h=q.CASE,p[q.CASE].open()}},h=q.TITLE,p[q.TITLE].open()},window.addEventListener("resize",function(a){h==q.BOARD&&f.setScale(l.getScale(k.boardSize,new j(window.innerWidth,window.innerHeight)))}),window.addEventListener("touchstart",function(a){h==q.BOARD&&window.matchMedia("only screen and (max-width: 760px)")&&document.documentElement.requestFullScreen()},!1)},{"./modules/game/constants.js":6,"./modules/game/game.js":7,"./modules/helper/point.js":13,"./modules/helper/utilities.js":14,"./modules/menus/caseMenu.js":16,"./modules/menus/profileMenu.js":17,"./modules/menus/titleMenu.js":18}],2:[function(a,b,c){"use strict";function d(a,b,c,d){this.name=a;var f=b.getElementsByTagName("button");this.questions=[];for(var g=0;g<f.length;g++)this.questions[g]=new e(f[g],c,d,g)}var e=a("./question.js");b.exports=d},{"./question.js":3}],3:[function(a,b,c){"use strict";function d(a,b,c,d){this.currentState=h.HIDDEN,this.windowDiv=c,this.num=d,this.correct=parseInt(a.getAttribute("correctAnswer")),this.positionPercentX=e.map(parseInt(a.getAttribute("xPositionPercent")),0,100,0,f.boardSize.x),this.positionPercentY=e.map(parseInt(a.getAttribute("yPositionPercent")),0,100,0,f.boardSize.y),this.revealThreshold=parseInt(a.getAttribute("revealThreshold")),this.imageLink=a.getAttribute("imageLink"),this.feedbacks=a.getElementsByTagName("feedback");var g=a.getAttribute("scale");""!==g&&g?this.scale=Number(g):this.scale=1,this.newFiles=!1,this.files=[];var i=a.getElementsByTagName("connections");this.connections=[];for(var j=0;j<i.length;j++)this.connections[j]=parseInt(i[j].innerHTML);switch(this.questionType=parseInt(a.getAttribute("questionType")),this.justification=1==this.questionType||3==this.questionType,5!=this.questionType&&(this.createTaskWindow(a),this.createResourceWindow(a,b)),this.questionType){case 5:this.createMessageWindow(a);break;case 4:this.createFileWindow();break;case 3:case 2:case 1:this.createAnswerWindow(a,3!=this.questionType)}}var e=a("../helper/utilities.js"),f=a("../game/constants.js"),g=a("../html/questionWindows.js"),h=Object.freeze({HIDDEN:0,UNSOLVED:1,SOLVED:2}),i=Object.freeze({JUSTIFICATION:1,MULTIPLE_CHOICE:2,SHORT_RESPONSE:3,FILE:4,MESSAGE:5}),j=d.prototype;j.showPrevSubmittedFiles=function(a){a.length>0?this.feedback.innerHTML="Submitted Files:<br/>":this.feedback.innerHTML="";for(var b=0;a>b;b++)this.feedback.innerHTML+='<span class="feedbackI">'+a[b].name+"</span><br/>"},j.wrongAnswer=function(a){this.feedbacks.length>0&&(this.feedback.innerHTML='"'+String.fromCharCode(a+"A".charCodeAt())+'" is not correct <br/>&nbsp;<span class="feedbackI">'+this.feedbacks[a].innerHTML+"</span><br/>"),this.taskContent&&(this.taskContent.scrollTop=this.taskContent.scrollHeight)},j.correctAnswer=function(){if(this.answers)for(var a=0;a<this.answers.length;a++)this.answers[a].disabled=!0;if(this.taskContent&&(this.taskContent.scrollTop=this.taskContent.scrollHeight),this.feedbacks.length>0&&(this.feedback.innerHTML='"'+String.fromCharCode(this.correct+"A".charCodeAt())+'" is the correct response <br/><span class="feedbackI">'+this.feedbacks[this.correct].innerHTML+"</span><br/>"),3===this.questionType&&""!=this.justification.value&&(this.feedback.innerHTML='Submitted Text:<br/><span class="feedbackI">'+this.justification.value+"</span><br/>"),1===this.questionType&&""!=this.justification.value&&(this.feedback.innerHTML+='Submitted Text:<br/><span class="feedbackI">'+this.justification.value+"</span><br/>"),4===this.questionType){this.files.length>0?this.feedback.innerHTML="Submitted Files:<br/>":this.feedback.innerHTML="";for(var a=0;a<this.files.length;a++)this.feedback.innerHTML+='<span class="feedbackI">'+this.files[a]+"</span><br/>"}this.currentState!=h.SOLVED&&((3===this.questionType||1===this.questionType)&&""!=this.justification.value||4===this.questionType&&this.fileInput.files.length>0||2===this.questionType)&&(this.currentState=h.SOLVED,this.proceedElement&&(this.proceedElement.style.display="block"))},j.displayWindows=function(){var a=this.windowDiv,b=new Image;b.src="../img/iconClose.png",b.className="exit-button";var c=this;b.onclick=function(){c.windowDiv.innerHTML=""},5===this.questionType?(a.appendChild(this.message),b.style.left="75vw"):(a.appendChild(this.task),a.appendChild(this.answer),a.appendChild(this.resource),b.style.left="85vw"),this.currentState===h.SOLVED&&this.questionType!=i.MESSAGE&&this.proceedElement&&(this.proceedElement.style.display="block"),a.appendChild(b)},j.createTaskWindow=function(a){this.proceedElement=document.getElementById("proceedContainer");var b=document.createElement("DIV");b.innerHTML=g.taskWindow,this.task=b.firstChild,this.task.innerHTML=this.task.innerHTML.replace("%title%",a.getElementsByTagName("questionName")[0].innerHTML.replace(/\n/g,"<br/>")),this.task.innerHTML=this.task.innerHTML.replace("%instructions%",a.getElementsByTagName("instructions")[0].innerHTML.replace(/\n/g,"<br/>")),this.task.innerHTML=this.task.innerHTML.replace("%question%",a.getElementsByTagName("questionText")[0].innerHTML.replace(/\n/g,"<br/>")),this.feedback=this.task.getElementsByClassName("feedback")[0],this.taskContent=this.task.getElementsByClassName("windowContent")[0]},j.createResourceWindow=function(a,b){var c=document.createElement("DIV");c.innerHTML=g.resourceWindow,this.resource=c.firstChild;var d=a.getElementsByTagName("resourceIndex");if(d.length>0){for(var e="",f=0;f<d.length;f++){var h=g.resource.replace("%icon%",b[parseInt(d[f].innerHTML)].icon);h=h.replace("%title%",b[parseInt(d[f].innerHTML)].title),h=h.replace("%link%",b[parseInt(d[f].innerHTML)].link),e+=h}this.resource.innerHTML=this.resource.innerHTML.replace("%resources%",e)}else this.resource.innerHTML=this.resource.innerHTML.replace("%resources%","No resources have been provided for this task."),this.resource.getElementsByClassName("windowContent")[0].style.color="grey",this.resource.getElementsByClassName("windowContent")[0].style.backgroundColor="#FFFFFF",this.resource.getElementsByClassName("windowContent")[0].className+=", center"},j.createAnswerWindow=function(a,b){var c=document.createElement("DIV");c.innerHTML=g.answerWindow,this.answer=c.firstChild;var d=this;if(this.justification&&(this.justification=document.createElement("textarea"),this.justification.submit=document.createElement("button"),this.justification.submit.className="answer submit",this.justification.submit.innerHTML="Submit",this.justification.submit.disabled=!0,this.justification.submit.onclick=function(){d.correctAnswer()},this.justification.addEventListener("input",function(){d.justification.value.length>0?d.justification.submit.disabled=!1:d.justification.submit.disabled=!0},!1)),b){this.answers=[];for(var e=a.getElementsByTagName("answer"),f=parseInt(a.getAttribute("correctAnswer")),h=0;h<e.length;h++)this.justification&&(this.justification.disabled=!0),this.answers[h]=document.createElement("button"),f===h?this.answers[h].className="answer correct":this.answers[h].className="answer wrong",this.answers[h].innerHTML=String.fromCharCode(h+"A".charCodeAt())+". "+e[h].innerHTML;for(var h=0;h<this.answers.length;h++)"answer wrong"==this.answers[h].className?(this.answers[h].num=h,this.answers[h].onclick=function(){this.disabled=!0,d.wrongAnswer(this.num)}):this.answers[h].onclick=function(){d.justification&&(d.justification.disabled=!1),d.correctAnswer()};for(var h=0;h<this.answers.length;h++)this.answer.getElementsByClassName("windowContent")[0].appendChild(this.answers[h])}this.justification&&(this.answer.getElementsByClassName("windowContent")[0].appendChild(this.justification),this.answer.getElementsByClassName("windowContent")[0].appendChild(this.justification.submit))},j.createFileWindow=function(){var a=document.createElement("DIV");a.innerHTML=g.fileWindow,this.answer=a.firstChild,this.fileInput=this.answer.getElementsByTagName("input")[0];var b=this;this.answer.getElementsByClassName("fileButton")[0].onclick=function(){console.log("FILE BUTTON CLICKED!"),b.fileInput.click()},this.fileInput.addEventListener("change",function(a){b.newFiles=!0,b.files=[];for(var c=0;c<a.target.files.length;c++)b.files[c]=a.target.files[c].name;b.correctAnswer()})},j.createMessageWindow=function(a){var b=document.createElement("DIV");b.innerHTML=g.messageWindow,this.message=b.firstChild,this.message.innerHTML=this.message.innerHTML.replace("%title%",a.getElementsByTagName("questionName")[0].innerHTML.replace(/\n/g,"<br/>")),this.message.innerHTML=this.message.innerHTML.replace("%instructions%",a.getElementsByTagName("instructions")[0].innerHTML.replace(/\n/g,"<br/>")),this.message.innerHTML=this.message.innerHTML.replace("%question%",a.getElementsByTagName("questionText")[0].innerHTML.replace(/\n/g,"<br/>"));var c=this;this.message.getElementsByTagName("button")[0].onclick=function(){c.currentState=h.SOLVED,c.windowDiv.innerHTML=""}},b.exports=d,b.exports.SOLVE_STATE=h},{"../game/constants.js":6,"../helper/utilities.js":14,"../html/questionWindows.js":15}],4:[function(a,b,c){"use strict";function d(a){var b=parseInt(a.getAttribute("type"));switch(b){case 0:this.icon="../img/iconResourceFile.png";break;case 1:this.icon="../img/iconResourceLink.png";break;case 2:this.icon="../img/iconResourceVideo.png";break;default:this.icon=""}this.title=a.getAttribute("text"),this.link=a.getAttribute("link")}a("./question.js");b.exports=d},{"./question.js":3}],5:[function(a,b,c){"use strict";function d(a,b,c){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.display="none",this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,a.appendChild(this.canvas);var d=this;this.canvas.addEventListener("animationend",function(){d.loaded&&d.loaded()},!1),this.lessonNodeArray=c,this.boardOffset=b,this.prevBoardOffset={x:0,y:0},this.zoom=h.startZoom,this.stage=0,this.lastSaveTime=0,this.lastQuestion=null,this.lastQuestionNum=-1;for(var e=!0,f=0;f<this.lessonNodeArray.length&&e;f++)this.lessonNodeArray[f].question.currentState!=g.SOLVE_STATE.SOLVED&&(e=!1);e?this.finished=!0:this.finished=!1}var e=a("../helper/utilities.js"),f=a("../helper/point.js"),g=a("../case/question.js"),h=a("./constants.js"),i=a("../helper/drawlib.js"),j=d.prototype;j.act=function(a,b,c){for(var d=0;d<this.lessonNodeArray.length;d++){var i=this.lessonNodeArray[d];if(i.currentState!=g.SOLVE_STATE.SOLVED&&i.question.currentState==g.SOLVE_STATE.SOLVED){for(var j=0;j<i.question.connections.length;j++)this.lessonNodeArray[Math.abs(i.question.connections[j])-1].connections++;i.currentState=i.question.currentState;for(var k=!0,d=0;d<this.lessonNodeArray.length&&k;d++)this.lessonNodeArray[d].currentState!=g.SOLVE_STATE.SOLVED&&(k=!1);k&&(this.finished=!0),this.updateNode&&this.updateNode()}i.question.currentState==g.SOLVE_STATE.SOLVED&&(i.linePercent=Math.min(1,c*h.lineSpeed+i.linePercent))}if(b){!b.mouseDown&&this.target&&(this.target.dragPosition=void 0,this.target.dragging=!1,this.target=null);for(var d=this.lessonNodeArray.length-1;d>=0&&null==this.target;d--){var l=this.lessonNodeArray[d];l.mouseOver=!1,e.mouseIntersect(b,l,this.boardOffset)&&(l.mouseOver=!0,this.target=l)}if(this.target)if(this.target.dragging){var m=b.virtualPosition.x-this.target.dragPosition.x;this.target.position.x=Math.max(h.boardOutline,Math.min(m,h.boardSize.x-h.boardOutline)),this.target.question.positionPercentX=this.target.position.x;var n=b.virtualPosition.y-this.target.dragPosition.y;this.target.position.y=Math.max(h.boardOutline,Math.min(n,h.boardSize.y-h.boardOutline)),this.target.question.positionPercentY=this.target.position.y}else b.mouseDown&&(this.target.dragging=!0,this.target.dragPosition=new f(b.virtualPosition.x-this.target.position.x,b.virtualPosition.y-this.target.position.y)),b.mouseClicked&&(this.target.click(b),this.lastQuestion=this.target.question);null==this.target&&(b.mouseDown?(this.canvas.style.cursor="-webkit-grabbing",this.canvas.style.cursor="-moz-grabbing",this.canvas.style.cursor="grabbing",this.mouseStartDragBoard?(this.boardOffset.x=this.prevBoardOffset.x-(b.virtualPosition.x-this.mouseStartDragBoard.x),this.boardOffset.x>this.maxBoardWidth/2&&(this.boardOffset.x=this.maxBoardWidth/2),this.boardOffset.x<-1*this.maxBoardWidth/2&&(this.boardOffset.x=-1*this.maxBoardWidth/2),this.boardOffset.y=this.prevBoardOffset.y-(b.virtualPosition.y-this.mouseStartDragBoard.y),this.boardOffset.y>this.maxBoardHeight/2&&(this.boardOffset.y=this.maxBoardHeight/2),this.boardOffset.y<-1*this.maxBoardHeight/2&&(this.boardOffset.y=-1*this.maxBoardHeight/2)):(this.mouseStartDragBoard=b.virtualPosition,this.prevBoardOffset.x=this.boardOffset.x,this.prevBoardOffset.y=this.boardOffset.y)):(this.mouseStartDragBoard=void 0,this.canvas.style.cursor=""))}},j.draw=function(a){this.ctx.save(),i.rect(this.ctx,0,0,this.canvas.width,this.canvas.height,"#15718F"),this.ctx.save(),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.scale(a,a),this.ctx.translate(-this.canvas.width/2,-this.canvas.height/2),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.scale(this.zoom,this.zoom),this.ctx.translate(-this.canvas.width/2,-this.canvas.height/2),this.ctx.translate(this.canvas.width/2-this.boardOffset.x,this.canvas.height/2-this.boardOffset.y),i.rect(this.ctx,0,0,h.boardSize.x,h.boardSize.y,"#D3B185"),i.strokeRect(this.ctx,-h.boardOutline/2,-h.boardOutline/2,h.boardSize.x+h.boardOutline/2,h.boardSize.y+h.boardOutline/2,h.boardOutline,"#CB9966");for(var b=0;b<this.lessonNodeArray.length;b++)this.lessonNodeArray[b].draw(this.ctx,this.canvas);for(var b=0;b<this.lessonNodeArray.length;b++)if(this.lessonNodeArray[b].question.currentState==g.SOLVE_STATE.SOLVED){var c=this.lessonNodeArray[b].getNodePoint();this.ctx.strokeStyle="rgba(0,0,105,0.2)",this.ctx.lineWidth=1;for(var d=0;d<this.lessonNodeArray[b].question.connections.length;d++)if(!(this.lessonNodeArray[b].question.connections[d]<0)&&this.lessonNodeArray[this.lessonNodeArray[b].question.connections[d]-1].question.currentState!=g.SOLVE_STATE.HIDDEN){var e=this.lessonNodeArray[this.lessonNodeArray[b].question.connections[d]-1],f=e.getNodePoint();this.ctx.beginPath(),this.ctx.moveTo(c.x,c.y),this.ctx.lineTo(c.x+(f.x-c.x)*this.lessonNodeArray[b].linePercent,c.y+(f.y-c.y)*this.lessonNodeArray[b].linePercent),this.ctx.closePath(),this.ctx.stroke()}}this.ctx.restore()},j.getFreeNode=function(){for(var a=0;a<this.lessonNodeArray.length;a++)if(this.lessonNodeArray[a].question.currentState==g.SOLVE_STATE.UNSOLVED)return this.lessonNodeArray[a];return null},j.moveTowards=function(a,b,c){var d=new f(a.x-this.boardOffset.x,a.y-this.boardOffset.y),e=Math.sqrt(d.x*d.x+d.y*d.y),g=new f(this.boardOffset.x+d.x/e*b*c,this.boardOffset.y+d.y/e*b*c);this.boardOffset.x!=a.x&&Math.abs(a.x-g.x)/(a.x-g.x)==Math.abs(a.x-this.boardOffset.x)/(a.x-this.boardOffset.x)?this.boardOffset.x=g.x:this.boardOffset.x=a.x,this.boardOffset.y!=a.y&&Math.abs(a.y-g.y)/(a.y-g.y)==Math.abs(a.y-this.boardOffset.y)/(a.y-this.boardOffset.y)?this.boardOffset.y=g.y:this.boardOffset.y=a.y},j.windowClosed=function(){return console.log("window closed:"+this.lastQuestion.newFiles),this.lastQuestion.newFiles?(this.lastQuestion.newFiles=!1,{files:this.lastQuestion.fileInput.files,question:this.lastQuestion.num}):void 0},j.show=function(a){null!=a&&(this.canvas.style.animation="canvasEnter"+(a?"L":"R")+" 1s"),this.canvas.style.display="inline-block"},j.hide=function(a){if(null!=a){this.canvas.style.animation="canvasLeave"+(a?"R":"L")+" 1s";var b=this;this.loaded=function(){b.canvas.style.display="none"}}else b.canvas.style.display="none"},j.updateSize=function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight},b.exports=d},{"../case/question.js":3,"../helper/drawlib.js":9,"../helper/point.js":13,"../helper/utilities.js":14,"./constants.js":6}],6:[function(a,b,c){"use strict";var d=a("../helper/point.js"),e=b.exports;e.boardSize=new d(1920,1080),e.boundSize=3,e.boardOutline=e.boardSize.x>e.boardSize.y?e.boardSize.x/20:e.boardSize.y/20,e.startZoom=.5,e.endZoom=1.5,e.zoomSpeed=.001,e.zoomMoveSpeed=.75,e.lineSpeed=.002,e.pinchSpeed=.0025},{"../helper/point.js":13}],7:[function(a,b,c){"use strict";function d(a,b){var c=this;this.active=!1,this.saveFiles=[],f=document.getElementById("window"),g=document.getElementById("windowWrapper"),i=document.getElementById("proceedContainer"),j=document.getElementById("proceedBtnLong"),k=document.getElementById("proceedBtnRound"),h=document.getElementById("windowFlim"),h.onclick=function(a){for(var b=!1,c=document.getElementsByClassName("windowContent"),d=0;d<c.length&&!b;d++){var e=c[d].getBoundingClientRect();e.left<a.clientX&&e.right>a.clientX&&e.top<a.clientY&&e.bottom>a.clientY&&(b=!0)}c=document.getElementsByClassName("title");for(var d=0;d<c.length&&!b;d++){var e=c[d].getBoundingClientRect();e.left<a.clientX&&e.right>a.clientX&&e.top<a.clientY&&e.bottom>a.clientY&&(b=!0)}b||(f.innerHTML="")},e=document.querySelector("#"+a.id+" #zoom-slider"),e.oninput=function(){c.setZoom(-parseFloat(e.value))},document.querySelector("#"+a.id+" #zoom-in").onclick=function(){e.stepDown(),c.setZoom(-parseFloat(e.value))},document.querySelector("#"+a.id+" #zoom-out").onclick=function(){e.stepUp(),c.setZoom(-parseFloat(e.value))},this.scale=b;var d=s.loadCase(JSON.parse(localStorage.caseData),document.querySelector("#"+a.id+" #window"));this.categories=d.categories,this.createLessonNodes(a);var l=document.createElement("button");l.innerHTML="Close Case",this.boardArray[this.boardArray.length-1].finished||(l.disabled=!0),l.onclick=function(){c.submit()},this.bottomBar.appendChild(l),this.activeBoardIndex=d.category,this.active=!0,this.boardArray[this.activeBoardIndex].show(),this.boardArray[this.activeBoardIndex].button.className="active",this.updateNode(),e.value=-this.getZoom(),s.prepareZip(document.querySelector("#"+a.id+" #blob"))}var e,f,g,h,i,j,k,l,m=a("./board.js"),n=a("../helper/point.js"),o=a("./lessonNode.js"),p=a("./constants.js"),q=(a("../helper/drawlib.js"),a("../helper/iparDataParser.js")),r=a("../helper/mouseState.js"),s=a("../helper/fileManager.js"),t=0,u=d.prototype;u.createLessonNodes=function(a){this.boardArray=[],this.bottomBar=document.querySelector("#"+a.id+" #bottomBar");for(var b=0;b<this.categories.length;b++){this.lessonNodes=[];for(var c=0;c<this.categories[b].questions.length;c++)this.lessonNodes.push(new o(new n(this.categories[b].questions[c].positionPercentX,this.categories[b].questions[c].positionPercentY),this.categories[b].questions[c].imageLink,this.categories[b].questions[c])),this.lessonNodes[this.lessonNodes.length-1].question=this.categories[b].questions[c];this.boardArray[b]=new m(a,new n(p.boardSize.x/2,p.boardSize.y/2),this.lessonNodes);var d=document.createElement("BUTTON");d.innerHTML=this.categories[b].name;var e=this;d.onclick=function(a){return function(){!e.active||e.zoomout||e.zoomin||e.changeBoard(a)}}(b),0==b||this.boardArray[b-1].finished||(d.disabled=!0),this.bottomBar.appendChild(d),this.boardArray[b].button=d;var e=this;this.boardArray[b].updateNode=function(){e.updateNode()}}this.mouseState=new r(this.boardArray)},u.update=function(a){this.active?(this.act(a),this.boardArray[this.activeBoardIndex].draw(this.scale)):0!=t&&""==f.innerHTML&&this.windowClosed()},u.act=function(a){if(this.mouseState.update(a,this.scale*this.getZoom()),this.boardArray[this.activeBoardIndex].act(this.scale,this.zoomin||this.zoomout?null:this.mouseState,a),this.activeBoardIndex<this.boardArray.length-1&&this.boardArray[this.activeBoardIndex+1].button.disabled&&this.boardArray[this.activeBoardIndex].finished&&(this.boardArray[this.activeBoardIndex+1].button.disabled=!1,this.prompt=!0),this.zoomout){var b=this.boardArray[this.activeBoardIndex];if(this.getZoom()>p.startZoom?b.zoom-=a*p.zoomSpeed:this.getZoom()<p.startZoom&&(b.zoom=p.startZoom),b.moveTowards(new n(p.boardSize.x/2,p.boardSize.y/2),a,p.zoomMoveSpeed),e.value=-this.getZoom(),this.getZoom()==p.startZoom&&b.boardOffset.x==p.boardSize.x/2&&b.boardOffset.y==p.boardSize.y/2){if(this.zoomout=!1,this.prompt){i.style.display="none",f.innerHTML='<div class="windowPrompt"><div><h1>The "'+this.categories[this.activeBoardIndex+1].name+'" category is now available!</h1></div></div>';var c=f.getElementsByClassName("windowPrompt")[0],d=function(){c.removeEventListener("animationend",d),setTimeout(function(){c.style.animation="promptFade 1s";var a=function(){c.style.animation="",c.removeEventListener("animationend",a),f.innerHTML="",f.style.animation=""};c.addEventListener("animationend",a,!1)},500)};f.style.animation="none",c.style.animation="openWindow 0.5s",c.addEventListener("animationend",d,!1),this.prompt=!1}if(null!=this.newBoard){var g=this.newBoard<this.activeBoardIndex;this.boardArray[this.activeBoardIndex].hide(g),this.activeBoardIndex=this.newBoard,this.boardArray[this.activeBoardIndex].show(g),e.value=-this.getZoom(),this.active=!1;var j=this;this.boardArray[this.activeBoardIndex].loaded=function(){j.active=!0,j.newBoard=null,j.updateNode()}}}}else if(this.zoomin){var b=this.boardArray[this.activeBoardIndex];b.finished||null!=this.targetNode?b.finished&&(this.zoomin=!1,this.zoomout=!0):this.targetNode=b.getFreeNode(),this.zoomin&&this.targetNode&&(this.getZoom()<p.endZoom?b.zoom+=a*p.zoomSpeed:this.getZoom()>p.endZoom&&(b.zoom=p.endZoom),b.moveTowards(this.targetNode.position,a,p.zoomMoveSpeed),e.value=-this.getZoom(),this.getZoom()==p.endZoom&&b.boardOffset.x==this.targetNode.position.x&&b.boardOffset.y==this.targetNode.position.y&&(this.zoomin=!1,this.targetNode=null))}else 0!=this.mouseState.zoomDiff?(e.value=l+this.mouseState.zoomDiff*p.pinchSpeed,this.updateZoom(-parseFloat(e.value))):l=Number(e.value),0!=this.mouseState.mouseWheelDY&&this.zoom(this.mouseState.mouseWheelDY<0);""!=f.innerHTML&&t++>3&&(this.active=!1,h.style.display="block")},u.updateNode=function(){this.zoomin=!0},u.getZoom=function(){return this.boardArray[this.activeBoardIndex].zoom},u.setZoom=function(a){this.boardArray[this.activeBoardIndex].zoom=a},u.zoom=function(a){a?e.stepDown():e.stepUp(),this.setZoom(-parseFloat(e.value))},u.setScale=function(a){for(var b=0;b<this.boardArray.length;b++)this.boardArray[b].updateSize();this.scale=a},u.changeBoard=function(a){a!=this.activeBoardIndex&&(this.boardArray[a].button.className="active",this.boardArray[this.activeBoardIndex].button.className="",this.newBoard=a,this.zoomout=!0)},u.windowClosed=function(){t=0,this.active=!0,h.style.display="none",i.style.display="none",this.save()},u.save=function(){var a=JSON.parse(localStorage.caseData);a.saveFile=q.createXMLSaveFile(this.activeBoardIndex,this.boardArray,!0);var b=this.boardArray[this.activeBoardIndex].windowClosed();b&&(b.board=this.activeBoardIndex,this.saveFiles.push(b),this.nextFileInSaveStack(a)),localStorage.caseData=JSON.stringify(a)},u.nextFileInSaveStack=function(a){var b=JSON.parse(localStorage.caseData);b.submitted=a.submitted,localStorage.caseData=JSON.stringify(b),this.saveFiles.length>0&&(s.removeFilesFor(a,this.saveFiles[0]),s.addNewFilesToSystem(a,this.saveFiles[0],this.nextFileInSaveStack.bind(this))),this.saveFiles.shift()},u.submit=function(){},b.exports=d},{"../helper/drawlib.js":9,"../helper/fileManager.js":10,"../helper/iparDataParser.js":11,"../helper/mouseState.js":12,"../helper/point.js":13,"./board.js":5,"./constants.js":6,"./lessonNode.js":8}],8:[function(a,b,c){"use strict";function d(a,b,c){this.position=a,this.dragLocation=void 0,this.mouseOver=!1,this.dragging=!1,this.type="lessonNode",this.image=new Image,this.check=new Image,this.width,this.height,this.question=c,this.connections=0,this.currentState=0,this.linePercent=0,c.currentState==e.SOLVE_STATE.SOLVED&&(this.linePercent=1);var d=this;this.image.onload=function(){d.width=d.image.naturalWidth,d.height=d.image.naturalHeight;var a=f.boardSize.x/10;if(d.width<a&&d.height<a){var b;b=d.width>d.height?a/d.width:a/d.height,d.width=d.width*b*d.question.scale,d.height=d.height*b*d.question.scale}if(d.width>a||d.height>a){var b;b=d.width>d.height?d.width/a:d.height/a,d.width=d.width/b,d.height=d.height/b}d.position.x+=d.width/2*d.question.scale,d.position.y+=d.height/2*d.question.scale},this.image.src=b,this.check.src=h}var e=(a("../helper/drawlib.js"),a("../case/question.js")),f=a("./constants.js"),g=a("../helper/point.js"),h="../img/iconPostItCheck.png",i=d.prototype;i.draw=function(a,b){if(this.question.currentState==e.SOLVE_STATE.HIDDEN){if(!(this.question.revealThreshold<=this.connections))return;this.question.currentState=e.SOLVE_STATE.UNSOLVED,this.currentState=this.question.currentState}switch(a.save(),this.dragging?(a.shadowColor="yellow",a.shadowBlur=5,b.style.cursor="-webkit-grabbing",b.style.cursor="-moz-grabbing",b.style.cursor="grabbing"):this.mouseOver&&(a.shadowColor="dodgerBlue",a.shadowBlur=5,b.style.cursor="pointer"),a.drawImage(this.image,this.position.x-this.width/2,this.position.y-this.height/2,this.width,this.height),this.question.currentState){case 1:a.fillStyle="blue",a.strokeStyle="cyan";break;case 2:a.drawImage(this.check,this.position.x+this.width/2-f.boardSize.x/50,this.position.y+this.height/2-f.boardSize.x/50,f.boardSize.x/50,f.boardSize.x/50),a.fillStyle="green",a.strokeStyle="yellow"}var c=this.width<this.height?this.width:this.height;a.lineWidth=c/32,a.beginPath();var d=this.getNodePoint();a.arc(d.x,d.y,3*c/32,0,2*Math.PI),a.closePath(),a.fill(),a.stroke(),a.restore()},i.getNodePoint=function(){var a=this.width<this.height?this.width:this.height;return new g(this.position.x-this.width/2+3*a/16,this.position.y-this.height/2+3*a/16)},i.click=function(a){this.question.displayWindows()},b.exports=d},{"../case/question.js":3,"../helper/drawlib.js":9,"../helper/point.js":13,"./constants.js":6}],9:[function(a,b,c){"use strict";var d=b.exports;d.clear=function(a,b,c,d,e){a.clearRect(b,c,d,e)},d.rect=function(a,b,c,d,e,f,g){a.save(),a.fillStyle=f,g?a.fillRect(b-d/2,c-e/2,d,e):a.fillRect(b,c,d,e),a.restore()},d.strokeRect=function(a,b,c,d,e,f,g,h){a.save(),a.strokeStyle=g,a.lineWidth=f,h?a.strokeRect(b-d/2,c-e/2,d,e):a.strokeRect(b,c,d,e),a.restore()},d.line=function(a,b,c,d,e,f,g){a.save(),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.lineWidth=f,a.strokeStyle=g,a.stroke(),a.restore()},d.circle=function(a,b,c,d,e){a.save(),a.beginPath(),a.arc(b,c,d,0,2*Math.PI,!1),a.fillStyle=e,a.fill(),a.restore()}},{}],10:[function(a,b,c){"use strict";function d(){var a=JSON.parse(localStorage.caseData),b=new JSZip;b.file("caseFile.ipardata",a.caseFile),b.file("saveFile.ipardata",a.saveFile);var c=b.folder("submitted");console.log(a.submitted);for(var d in a.submitted)if(a.submitted.hasOwnProperty(d)){var e=a.submitted[d].indexOf("base64,")+"base64,".length;c.file(d,a.submitted[d].substr(e),{base64:!0})}b.generateAsync({type:"base64"}).then(function(a){var b=document.createElement("a");b.style.display="none",b.href="data:application/zip;base64,"+a,b.download=localStorage.caseName,document.body.appendChild(b),b.click(),document.body.removeChild(b)})}var e=(a("../case/category.js"),a("../case/resources.js"),a("./utilities.js")),f=a("./iparDataParser.js"),g=b.exports;g.loadCase=function(a,b){this.categories=[],this.questions=[];var c=e.getXml(a.caseFile),d=f.getCategoriesAndQuestions(c,b),g=e.getXml(a.saveFile);if(!g)return void alert("ERROR no save data found, or save data was unreadable");var h=g.getElementsByTagName("case")[0].getAttribute("caseStatus");if(h>0){for(var i in a.submitted)if(a.submitted.hasOwnProperty(i)){i=i.substr(i.lastIndexOf("/")+1);var j=i.indexOf("-"),k=i.indexOf("-",j+1),l=i.indexOf("-",k+1);d[Number(i.substr(0,j))].questions[Number(i.substr(j+1,k-j-1))].files[Number(i.substr(k+1,l-k-1))]=i.substr(i.indexOfAt("-",3)+1)}console.log(d[1].questions[4].files),console.log(d[1].questions[4].imageLink),f.assignQuestionStates(d,g.getElementsByTagName("question"))}else h=1;return{categories:d,category:h-1}},g.prepareZip=function(a){JSZip.support.blob&&(a.onclick=d)},g.removeFilesFor=function(a,b){var c=b.board+"-"+b.question+"-";for(var d in a.submitted)a.submitted.hasOwnProperty(d)&&d.startsWith(c)&&delete a.submitted[d]},g.addNewFilesToSystem=function(a,b,c){for(var d=1,e=0,f=function(){++e>=d&&c(a)},g=0;g<b.files.length;g++)!function(){var c=new FileReader,e=b.board+"-"+b.question+"-"+g+"-"+b.files[g].name;d++,c.onload=function(b){a.submitted[e]=b.target.result,f()},c.readAsDataURL(b.files[g])}();f()}},{"../case/category.js":2,"../case/resources.js":4,"./iparDataParser.js":11,"./utilities.js":14}],11:[function(a,b,c){"use strict";var d=a("../case/category.js"),e=a("../case/resources.js"),f=a("./utilities.js"),g=a("../game/constants.js"),h=a("../case/question.js"),i={hidden:h.SOLVE_STATE.HIDDEN,unsolved:h.SOLVE_STATE.UNSOLVED,correct:h.SOLVE_STATE.SOLVED},j=["hidden","unsolved","correct"],k="unassigned",l="unassigned",m="email",n=b.exports;n.assignQuestionStates=function(a,b){console.log("qelems: "+b.length);for(var c=0,d=0;d<a.length;d++){console.log("CATEGORY "+d);for(var e=0;e<a[d].questions.length;e++,c++){var j=a[d].questions[e],k=b[c];j.currentState=i[k.getAttribute("questionState")],j.justification&&(j.justification.value=k.getAttribute("justification")),j.currentState==h.SOLVE_STATE.SOLVED&&j.correctAnswer(),j.positionPercentX=f.map(parseInt(k.getAttribute("positionPercentX")),0,100,0,g.boardSize.x),j.positionPercentY=f.map(parseInt(k.getAttribute("positionPercentY")),0,100,0,g.boardSize.y)}}},n.getCategoriesAndQuestions=function(a,b){if(null!=a){k=a.getElementsByTagName("case")[0].getAttribute("profileFirst"),l=a.getElementsByTagName("case")[0].getAttribute("profileLast"),a.getElementsByTagName("case")[0].getAttribute("profileMail");for(var c=a.getElementsByTagName("resourceList")[0].getElementsByTagName("resource"),f=[],g=0;g<c.length;g++)f[g]=new e(c[g]);for(var h=a.getElementsByTagName("category"),i=a.getElementsByTagName("categoryList")[0].getElementsByTagName("element"),j=[],g=0;g<h.length;g++)j[g]=new d(i[g].innerHTML,h[g],f,b);return j}return null;
},n.recreateCaseFile=function(a){var b=n.createXMLSaveFile(a,!0);return console.log("saveData.ipar data created"),b},n.createXMLSaveFile=function(a,b,c){var d;d=c?"\n":"";var e='<?xml version="1.0" encoding="utf-8"?>'+d;e+='<case categoryIndex="3" caseStatus="'+(a+1)+'" profileFirst="'+k+'" profileLast="'+l+'" profileMail="'+m+'">'+d,e+="<questions>"+d;for(var h=0;h<b.length;h++)for(var i=0;i<b[h].lessonNodeArray.length;i++){var n=b[h].lessonNodeArray[i].question;e+="<question ",e+='questionState="'+j[n.currentState]+'" ';var o,p=n.justification.value;o=p?p:n.justificationString,o||(o=""),e+='justification="'+o+'" ',e+='animated="'+(2==n.currentState)+'" ',e+='linesTraced="0" ',e+='revealThreshold  ="'+n.revealThreshold+'" ',e+='positionPercentX="'+f.map(n.positionPercentX,0,g.boardSize.x,0,100)+'" ',e+='positionPercentY="'+f.map(n.positionPercentY,0,g.boardSize.y,0,100)+'" ',e+="/>"+d}return e+="</questions>"+d,e+="</case>"+d}},{"../case/category.js":2,"../case/question.js":3,"../case/resources.js":4,"../game/constants.js":6,"./utilities.js":14}],12:[function(a,b,c){"use strict";function d(a){g=new o(0,0),h=new o(0,0),this.virtualPosition=new o(0,0);for(var b=this,c=0;c<a.length;c++){var d=a[c].canvas;d.addEventListener("mousemove",function(a){a.preventDefault(),e(a)}),d.addEventListener("touchmove",function(a){a.preventDefault(),l?f(a):e(a.touches[0])}),d.addEventListener("mousedown",function(a){a.preventDefault(),b.mouseDown=!0}),d.addEventListener("touchstart",function(a){a.preventDefault(),1!=a.touches.length||l?2==a.touches.length&&(b.mouseDown=!1,l=!0,f(a),n=m):(e(a.touches[0]),setTimeout(function(){b.mouseDown=!0}))}),d.addEventListener("mouseup",function(a){a.preventDefault(),b.mouseDown=!1}),d.addEventListener("touchend",function(a){a.preventDefault(),l&&(l=!1,m=0,n=0),b.mouseDown=!1}),d.addEventListener("mouseover",function(a){b.mouseIn=!0}),d.addEventListener("mouseout",function(a){b.mouseIn=!1,b.mouseDown=!1}),d.addEventListener("mousewheel",function(a){a.preventDefault(),k+=a.deltaY},!1)}this.mouseDown=!1,this.mouseIn=!1,i=0,k=0,this.mouseWheelDY=0,this.zoomDiff=0,m=0,this.mouseClicked=!1,j=200}function e(a){g=new o(a.clientX,a.clientY),h=new o(g.x-window.innerWidth/2,g.y-window.innerHeight/2)}function f(a){var b=[new o(a.touches[0].clientX,a.touches[0].clientY),new o(a.touches[1].clientX,a.touches[1].clientY)];m=Math.sqrt(Math.pow(b[0].x-b[1].x,2)+Math.pow(b[0].y-b[1].y,2))}var g,h,i,j,k,l,m,n,o=a("./point.js"),p=d.prototype;p.update=function(a,b){this.virtualPosition=new o(h.x/b,h.y/b),this.mouseWheelDY=k,k=0,l?this.zoomDiff=n-m:this.zoomDiff=0,this.mouseClicked=!1,this.mouseDown?i+=a:(i>0&&j>i&&(this.mouseClicked=!0),i=0),this.prevMouseDown=this.mouseDown,this.hasTarget=!1},b.exports=d},{"./point.js":13}],13:[function(a,b,c){"use strict";function d(a,b){this.x=a,this.y=b}var e=d.prototype;e.add=function(a,b){return b?new d(this.x+a,this.y+b):new d(this.x+a.x,this.y+a.y)},e.mult=function(a,b){return b?new d(this.x*a,this.y*b):new d(this.x*a.x,this.y*a.y)},e.scale=function(a){return new d(this.x*a,this.y*a)},b.exports=d},{}],14:[function(a,b,c){"use strict";var d=a("./point.js"),e=b.exports;e.getMouse=function(a){return new d(a.pageX-a.target.offsetLeft,a.pageY-a.target.offsetTop)},e.map=function(a,b,c,d,e){return d+(e-d)*((a-b)/(c-b))},e.clamp=function(a,b,c){return Math.max(b,Math.min(c,a))},e.mouseIntersect=function(a,b,c){return a.virtualPosition.x>b.position.x-b.width/2-c.x&&a.virtualPosition.x<b.position.x+b.width/2-c.x?a.virtualPosition.y>b.position.y-b.height/2-c.y&&a.virtualPosition.y<b.position.y+b.height/2-c.y:!1},e.getXml=function(a){for(a=a.trim();a.charCodeAt(0)<=32;)a=a.substr(1);a=a.trim();var b;if(window.DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml")}else b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a);return b},e.getScale=function(a,b){return b.y/a.x*a.y<b.x?b.y/a.y:b.x/a.x},e.replaceAll=function(a,b,c){for(;a.indexOf(b)>-1;)a=a.replace(b,c);return a},String.prototype.indexOfAt=function(a,b){for(var c=0,d=0;b>d&&-1!=c;d++)c=this.indexOf(a,c+1);return c}},{"./point.js":13}],15:[function(a,b,c){var d=b.exports;d.taskWindow='<div class="window left">	<div class="title">		Task	</div>	<div class="windowContent" style="overflow-y: scroll;height:35vh;">		<h3><b>%title%</b></h3>		<p>%instructions%</p>		<hr>		<p><b>%question%</b></p>		<hr>		<p class="feedback"></p>	</div></div>',d.resourceWindow='<div class="window left">	<div class="title">		Resource	</div>	<div class="windowContent" style="overflow-y: scroll; height:20vh;">		%resources%	</div></div>',d.resource='<div class="resourceItem">  <img src="%icon%"/>  %title%  <a href="%link%" target="_blank">    <div class="center">      Open      <img src="../img/iconLaunch.png"/>    </div>  </a></div>',d.answerWindow='<div class="window right">	<div class="title">		Answers	</div>	<div class="windowContent" style="min-height:20vh;">		</div></div>',d.fileWindow='<div class="window right">  <div class="title">    Files  </div>  <div class="windowContent" style="height:25vh;min-height: 100px;">	<div class="fileButton full">		<img src="../img/iconFileSubmit.png"/><br>		Browse And Submit	</div>    <input type="file" style="display:none;" multiple/>  </div></div>',d.messageWindow='<div class="window">	<div class="title">		Message	</div>	<div class="windowContent" style="height:80vh;overflow-y:scroll;">		<p><b>From </b>%title%</p>		<hr>		<p><b>Subject </b>%instructions%</p>		<hr>		<p>%question%</p>	  <button class="answer">Mark as Read</button>	</div></div>'},{}],16:[function(a,b,c){function d(a){e=a,k=m.NONE,f=document.querySelector("#"+e.id+" #title"),g=document.querySelector("#"+e.id+" #description"),h=document.querySelector("#"+e.id+" #resume-button"),i=document.querySelector("#"+e.id+" #start-button"),j=document.querySelector("#"+e.id+" #back-button");var b=this;h.onclick=function(){b.next=m.OLD_PROFILE,b.close()},i.onclick=function(){b.next=m.NEW_PROFILE,b.close()},j.onclick=function(){b.next=m.TITLE,b.close()}}var e,f,g,h,i,j,k,l=a("../helper/utilities.js"),m=Object.freeze({NONE:0,TITLE:1,NEW_PROFILE:2,OLD_PROFILE:3}),n=d.prototype;n.open=function(){e.style.display="";var a=JSON.parse(localStorage.caseData),b=l.getXml(a.caseFile).getElementsByTagName("case")[0];f.innerHTML=b.getAttribute("caseName"),g.innerHTML=b.getAttribute("description"),caseStatus=l.getXml(a.saveFile).getElementsByTagName("case")[0].getAttribute("caseStatus");var c="";switch(caseStatus){case"0":c="",h.disabled=!0;break;case"1":c=" [In Progress]";break;case"2":c=" [Completed]"}f.innerHTML+=c},n.close=function(){e.style.display="none",this.onclose&&this.onclose()},b.exports=d,b.exports.NEXT=m},{"../helper/utilities.js":14}],17:[function(a,b,c){function d(a){e=a,q=s.NONE,f=document.querySelector("#"+e.id+" #title"),g=document.querySelector("#"+e.id+" #first-name"),h=document.querySelector("#"+e.id+" #last-name"),i=document.querySelector("#"+e.id+" #email"),j=document.querySelector("#"+e.id+" #input-first-name"),k=document.querySelector("#"+e.id+" #input-last-name"),l=document.querySelector("#"+e.id+" #input-email"),m=document.querySelector("#"+e.id+" #proceed-button"),n=document.querySelector("#"+e.id+" #back-button"),n.onclick=function(){b.next=s.CASE,b.close()};var b=this;m.onclick=function(){b.next=s.BOARD,o?(p.setAttribute("profileFirst",j.value),p.setAttribute("profileLast",k.value),p.setAttribute("profileMail",l.value),p.setAttribute("caseStatus","0")):p.setAttribute("caseStatus","1");var a=JSON.parse(localStorage.caseData);a.saveFile=(new XMLSerializer).serializeToString(p),localStorage.caseData=JSON.stringify(a),b.close()}}var e,f,g,h,i,j,k,l,m,n,o,p,q,r=a("../helper/utilities.js"),s=Object.freeze({NONE:0,CASE:1,BOARD:2}),t=d.prototype;t.open=function(a){o=a,e.style.display="";var b=JSON.parse(localStorage.caseData),c=r.getXml(b.saveFile);if(p=c.getElementsByTagName("case")[0],o){f.innerHTML="Enter Profile Information",i.style.display="",j.style.display="",k.style.display="",g.innerHTML="",h.innerHTML="";var d=function(){""==j.value||""==k.value||""==l.value?m.disabled=!0:m.disabled=!1};j.addEventListener("change",d),k.addEventListener("change",d),l.addEventListener("change",d),d()}else f.innerHTML="Confirm Profile Information",i.style.display="none",j.style.display="none",k.style.display="none",g.innerHTML=p.getAttribute("profileFirst"),g.style.fontWeight="bold",h.innerHTML=p.getAttribute("profileLast"),h.style.fontWeight="bold",m.disabled=!1},t.close=function(){e.style.display="none",this.onclose&&this.onclose()},b.exports=d,b.exports.NEXT=s},{"../helper/utilities.js":14}],18:[function(a,b,c){function d(a){e=a,k=l.NONE,f=document.querySelector("#"+e.id+" #load-input"),g=document.querySelector("#"+e.id+" #load-button"),h=document.querySelector("#"+e.id+" #demo-button"),i=document.querySelector("#"+e.id+" #continue-button"),j=document.querySelector("#"+e.id+" #menu-button"),h.onclick=this.demo.bind(this),g.onclick=f.click.bind(f),f.addEventListener("change",this.loadFile.bind(this),!1),i.onclick=this.close.bind(this),j.onclick=function(){window.location.href="../index.html"}}var e,f,g,h,i,j,k,l=Object.freeze({NONE:0,BOARD:1,CASE:2}),m=d.prototype;m.open=function(){localStorage.caseData?i.disabled=!1:i.disabled=!0,this.next=l.BOARD,e.style.display="",g.disabled=!1,f.disabled=!1,h.disabled=!1,j.disabled=!1},m.demo=function(){if(!localStorage.caseData||confirm("Are you sure you want to start a new case? Your autosave data will be lost!")){g.disabled=!0,f.disabled=!0,h.disabled=!0,i.disabled=!0,j.disabled=!0;var a=this,b=new XMLHttpRequest;b.responseType="arraybuffer",b.onreadystatechange=function(){if(4==b.readyState&&200==b.status){localStorage.setItem("autosave",""),localStorage.caseName="demo.ipar";var c=new Worker("../lib/unzip.js");c.onmessage=function(b){localStorage.caseData=JSON.stringify(b.data),a.next=l.BOARD,console.log(b.data),a.close()},c.postMessage(b.response)}},b.open("GET","demo.ipar",!0),b.send()}},m.loadFile=function(a){if(!localStorage.caseData||confirm("Are you sure you want to start a new case? Your autosave data will be lost!")){if(!f.value.endsWith("ipar"))return void alert("You didn't choose an ipar file! you can only load ipar files!");localStorage.caseName=a.target.files[0].name,g.disabled=!0,f.disabled=!0,h.disabled=!0,i.disabled=!0,j.disabled=!0;var b=this,c=new FileReader;c.onload=function(a){localStorage.setItem("autosave","");var c=new Worker("../lib/unzip.js");c.onmessage=function(a){localStorage.caseData=JSON.stringify(a.data),b.next=l.CASE,b.close()},c.postMessage(a.target.result)},c.readAsArrayBuffer(a.target.files[0])}},m.close=function(){e.style.display="none",this.onclose&&this.onclose()},b.exports=d,b.exports.NEXT=l},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]);