!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){g.style.display="block",f=new i(document.getElementById("board"),l.getScale(k.boardSize,new j(window.innerWidth,window.innerHeight))),e(Date.now())}function e(a){f.update(Date.now()-a),window.requestAnimationFrame(e.bind(this,Date.now()))}document.documentElement.requestFullScreen=document.documentElement.requestFullScreen||document.documentElement.webkitRequestFullScreen||document.documentElement.mozRequestFullScreen;var f,g,h,i=a("./modules/game/game.js"),j=a("./modules/helper/point.js"),k=a("./modules/game/constants.js"),l=a("./modules/helper/utilities.js"),m=a("./modules/menus/titleMenu.js"),n=a("./modules/menus/createMenu.js"),o=[],p=Object.freeze({TITLE:0,CREATE:1,BOARD:2});window.onload=function(a){g=document.getElementById("board"),o[p.TITLE]=new m(document.getElementById("titleMenu")),o[p.TITLE].onclose=function(){switch(this.next){case m.NEXT.BOARD:h=p.BOARD,d();break;case m.NEXT.CREATE:h=p.CREATE,o[h].open()}},o[p.CREATE]=new n(document.getElementById("createMenu")),o[p.CREATE].onclose=function(){switch(this.next){case n.NEXT.BOARD:h=p.BOARD,d();break;case n.NEXT.TITLE:h=p.TITLE,o[h].open()}},h=p.TITLE,o[p.TITLE].open()},window.addEventListener("resize",function(a){h==p.BOARD&&f.setScale(l.getScale(k.boardSize,new j(window.innerWidth,window.innerHeight)))}),window.addEventListener("touchstart",function(a){h==p.BOARD&&window.matchMedia("only screen and (max-width: 760px)")&&document.documentElement.requestFullScreen()},!1),window.addEventListener("contextmenu",function(a){a.preventDefault()})},{"./modules/game/constants.js":6,"./modules/game/game.js":7,"./modules/helper/point.js":14,"./modules/helper/utilities.js":15,"./modules/menus/createMenu.js":18,"./modules/menus/titleMenu.js":20}],2:[function(a,b,c){"use strict";function d(a,b,c,d){this.name=a;var f=b.getElementsByTagName("button");this.questions=[];for(var g=0;g<f.length;g++)this.questions[g]=new e(f[g],c,d,g)}var e=a("./question.js"),f=d.prototype;f.xml=function(a,b){var c=a.createElement("category");c.setAttribute("categoryDesignation",b),c.setAttribute("questionCount",this.questions.length);for(var d=0;d<this.questions.length;d++)c.appendChild(this.questions[d].xml);return c},b.exports=d},{"./question.js":3}],3:[function(a,b,c){"use strict";function d(a,b,c,d){this.currentState=h.HIDDEN,this.windowDiv=c,this.num=d,this.xml=a,this.resources=b,this.refresh()}var e=(a("../helper/utilities.js"),a("../game/constants.js"),a("../html/questionWindows.js")),f=a("../menus/popup.js"),g=a("../html/popupWindows.js"),h=Object.freeze({HIDDEN:0,UNSOLVED:1,SOLVED:2}),i=(Object.freeze({JUSTIFICATION:1,MULTIPLE_CHOICE:2,SHORT_RESPONSE:3,FILE:4,MESSAGE:5}),d.prototype);i.refresh=function(){this.correct=parseInt(this.xml.getAttribute("correctAnswer")),this.positionPercentX=Number(this.xml.getAttribute("xPositionPercent")),this.positionPercentY=Number(this.xml.getAttribute("yPositionPercent")),this.revealThreshold=parseInt(this.xml.getAttribute("revealThreshold")),this.imageLink=this.xml.getAttribute("imageLink"),this.feedbacks=this.xml.getElementsByTagName("feedback");var a=this.xml.getAttribute("scale");""!==a&&a?this.scale=Number(a):this.scale=1,this.save=!1;var b=this.xml.getElementsByTagName("connections");this.connections=[];for(var c=0;c<b.length;c++)this.connections[c]=parseInt(b[c].innerHTML);this.questionType=parseInt(this.xml.getAttribute("questionType")),this.createWindows(),this.createTypeWindow()},i.saveXML=function(){this.xml.setAttribute("xPositionPercent",this.positionPercentX),this.xml.setAttribute("yPositionPercent",this.positionPercentY),this.xml.setAttribute("revealThreshold",this.revealThreshold),this.xml.setAttribute("scale",this.scale),this.xml.setAttribute("correctAnswer",this.correct),this.xml.setAttribute("questionType",this.questionType);for(var a=this.xml.getElementsByTagName("connections")[0];null!=a;)this.xml.removeChild(a),a=this.xml.getElementsByTagName("connections")[0];for(var b=0;b<this.connections.length;b++){var c=this.xml.ownerDocument.createElement("connections");c.innerHTML=this.connections[b],this.xml.appendChild(c)}},i.createWindows=function(){this.justification=1==this.questionType||3==this.questionType,5!=this.questionType?(this.createTaskWindow(),this.createResourceWindow(this.resources),this.questionType<=2&&this.createAnswerWindow()):this.createMessageWindow()},i.displayWindows=function(){this.windowDiv.innerHTML="";var a=this.windowDiv,b=new Image;b.src="../img/iconClose.png",b.className="exit-button";var c=this;b.onclick=function(){c.windowDiv.innerHTML=""},this.questionType<=2&&(a.appendChild(this.answer),this.typeWindow.className="window left",this.task.className="window left",this.resource.className="window left",b.style.right="5vw"),a.appendChild(this.typeWindow),5===this.questionType?(a.appendChild(this.message),b.style.right="25vw",this.typeWindow.className="window"):(this.questionType>2&&(this.typeWindow.className="window",this.task.className="window",this.resource.className="window",b.style.right="25vw"),a.appendChild(this.task),a.appendChild(this.resource)),a.appendChild(b)},i.createTypeWindow=function(){var a=document.createElement("DIV");a.innerHTML=e.questionTypeWindow,this.typeWindow=a.firstChild,this.typeWindow.getElementsByTagName("img")[0].src=this.imageLink;var b=this,c=this.typeWindow.getElementsByClassName("imageButton")[0],d=c.getElementsByTagName("img")[0];c.onclick=function(){b.windowDiv.innerHTML="",b.windowDiv.appendChild(b.imagesWindow);var a=b.imagesWindow.getElementsByTagName("button"),e=b.imagesWindow.getElementsByTagName("img"),h=b.imagesWindow.getElementsByTagName("input")[0],i=b.imagesWindow.getElementsByClassName("imageContent")[0],j=function(){a[0].onclick=function(){},a[1].onclick=function(){};for(var c=0;c<e.length;c++)e[c].onclick=function(){};b.displayWindows()};a[0].onclick=j,a[1].onclick=h.click.bind(h),a[2].onclick=function(){f.prompt(b.windowDiv,"Select Image","Image URL:","","Load Image",function(a){a&&(i.innerHTML+=g.image.replace(/%image%/g,a)),j(),c.click()})};for(var k=0;k<e.length;k+=2)!function(a){e[a].onclick=function(){b.imageLink=e[a].src,b.xml.setAttribute("imageLink",e[a].src),d.src=e[a].src,j()},e[a+1].onclick=function(){if(confirm("Are you sure you want to remove this image from your data bank? This can not be undone!")){var d=b.imagesWindow.getElementsByClassName("image")[a/2];d.parentNode.removeChild(d),j(),c.click()}}}(k);h.onchange=function(){if(h.files.length>0&&h.files[0].type.match(/^image.*/)){for(var b=0;b<a.length;b++)a[b].disabled=!0;var d=new FormData;d.append("image",h.files[0],h.files[0].name);var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){for(var b=0;b<a.length;b++)a[b].disabled=!1;i.innerHTML+=g.image.replace(/%image%/g,window.location.href.substr(0,window.location.href.substr(0,window.location.href.length-1).lastIndexOf("/"))+"/image/"+e.responseText),j(),c.click()}},e.open("POST","../image.php",!0),e.send(d)}}};var h=this.typeWindow.getElementsByTagName("select")[0];h.value=this.questionType,h.onchange=function(){b.questionType=Number(this.value),b.createWindows(),b.displayWindows()},this.typeWindow.getElementsByClassName("windowButtons")[0].getElementsByTagName("button")[0].onclick=function(){b.save=!0,b.windowDiv.innerHTML=""}},i.createTaskWindow=function(){this.proceedElement=document.getElementById("proceedContainer");var a=document.createElement("DIV");a.innerHTML=e.taskWindow,this.task=a.firstChild,this.task.innerHTML=this.task.innerHTML.replace("%title%",this.xml.getElementsByTagName("questionName")[0].innerHTML.replace(/\n/g,"<br/>")),this.task.innerHTML=this.task.innerHTML.replace("%instructions%",this.xml.getElementsByTagName("instructions")[0].innerHTML.replace(/\n/g,"<br/>")),this.task.innerHTML=this.task.innerHTML.replace("%question%",this.xml.getElementsByTagName("questionText")[0].innerHTML.replace(/\n/g,"<br/>"));for(var b=this.task.getElementsByClassName("text-box"),c=0;c<b.length;c++)b[c].onblur=this.updateXML.bind(this,b)},i.updateXML=function(a){this.xml.getElementsByTagName("questionName")[0].innerHTML=a[0].innerHTML,this.xml.getElementsByTagName("instructions")[0].innerHTML=a[1].innerHTML,this.xml.getElementsByTagName("questionText")[0].innerHTML=a[2].innerHTML},i.createResourceWindow=function(a){var b=document.createElement("DIV");b.innerHTML=e.resourceWindow,this.resource=b.firstChild,this.resourceDiv=this.resource.getElementsByClassName("resourceContent")[0],this.updateResources(a);var c=this;this.resource.getElementsByTagName("button")[0].onclick=function(){a.openWindow(c.windowDiv,!0,function(a){if(null!=a){var b=c.xml.ownerDocument.createElement("resourceIndex");b.innerHTML=a,c.xml.appendChild(b),c.updateResources(this)}c.displayWindows()})}},i.updateResources=function(a){var b=this.xml.getElementsByTagName("resourceIndex"),c=this;if(0==b.length)this.resourceDiv.color="grey",this.resourceDiv.className="resourceContent center",this.resourceDiv.innerHTML="No resources have been added.";else{this.resourceDiv.color="",this.resourceDiv.className="resourceContent",this.resourceDiv.innerHTML="";for(var d=[],f=0;f<b.length;f++)-1==d.indexOf(b[f].innerHTML)?d.push(b[f].innerHTML):(this.xml.removeChild(b[f]),f=0,b=this.xml.getElementsByTagName("resourceIndex"));for(var f=0;f<b.length;f++){var g=e.resource.replace("%icon%",a[parseInt(b[f].innerHTML)].icon);g=g.replace("%title%",a[parseInt(b[f].innerHTML)].title),g=g.replace("%link%",a[parseInt(b[f].innerHTML)].link);var h=document.createElement("DIV");h.innerHTML=g,g=h.firstChild,this.resourceDiv.appendChild(g),function(b){g.getElementsByClassName("delete")[0].onclick=function(){c.xml.removeChild(b),c.updateResources(a)}}(b[f])}}},i.createAnswerWindow=function(){var a=document.createElement("DIV");a.innerHTML=e.answerWindow,this.answer=a.firstChild;var b=this;this.answerForm=this.answer.getElementsByTagName("form")[0];var c=this.answer.getElementsByTagName("select")[0];c.onchange=function(){b.setNumberAnswers(Number(this.value))},this.setNumberAnswers(Number(this.xml.getAttribute("numAnswers"))),c.value=this.xml.getAttribute("numAnswers"),this.answerForm.elements.answer.value=this.correct+1,this.answerForm.onchange=function(){if(b.justification&&Number(this.elements.answer.value)-1!=b.correct){for(var a=0;a<this.elements.length;a++)this.elements[a].disabled=!1;this.elements["feedback"+this.elements.answer.value].disabled=!0}b.correct=Number(this.elements.answer.value)-1;for(var c=b.xml.getElementsByTagName("answer"),d=b.xml.getElementsByTagName("feedback"),a=0;a<c.length;a++)c[a].innerHTML=this.elements["answer"+(a+1)].value,d[a].innerHTML=this.elements["feedback"+(a+1)].value},this.correct=-1,this.answerForm.onchange()},i.setNumberAnswers=function(a){for(var b=this.xml.getElementsByTagName("answer"),c=this.xml.getElementsByTagName("feedback"),d=this.answerForm.getElementsByTagName("div"),f=0;f<d.length;f++){var g=d[f].getElementsByTagName("input");b[f].innerHTML=g[0].value,c[f].innerHTML=g[1].value}if(this.xml.setAttribute("numAnswers",a),b.length<a)for(var f=b.length;a>f;f++)this.xml.appendChild(this.xml.ownerDocument.createElement("answer")),this.xml.appendChild(this.xml.ownerDocument.createElement("feedback"));else if(b.length>a)for(;b.length>a;){this.xml.removeChild(b[b.length-1]),this.xml.removeChild(c[c.length-1]);var c=this.xml.getElementsByTagName("feedback");b=this.xml.getElementsByTagName("answer")}this.answerForm.innerHTML="";for(var f=0;f<b.length;f++)this.answerForm.innerHTML+=e.answer.replace(/%num%/g,f+1).replace(/%answer%/g,b[f].innerHTML).replace(/%feedback%/g,c[f].innerHTML);this.correct<b.length?this.answerForm.elements.answer.value=this.correct+1:(this.answerForm.elements.answer.value=1,this.correct=0)},i.createFileWindow=function(){var a=document.createElement("DIV");a.innerHTML=e.fileWindow,this.answer=a.firstChild,this.fileInput=this.answer.getElementsByTagName("input")[0];var b=this;this.fileInput.addEventListener("change",function(a){b.newFiles=!0,b.files=[];for(var c=0;c<a.target.files.length;c++)b.files[c]=a.target.files[c].name;b.correctAnswer()})},i.createMessageWindow=function(){var a=document.createElement("DIV");a.innerHTML=e.messageWindow,this.message=a.firstChild,this.message.innerHTML=this.message.innerHTML.replace("%title%",this.xml.getElementsByTagName("questionName")[0].innerHTML.replace(/\n/g,"<br/>")),this.message.innerHTML=this.message.innerHTML.replace("%instructions%",this.xml.getElementsByTagName("instructions")[0].innerHTML.replace(/\n/g,"<br/>")),this.message.innerHTML=this.message.innerHTML.replace("%question%",this.xml.getElementsByTagName("questionText")[0].innerHTML.replace(/\n/g,"<br/>"));for(var b=this.message.getElementsByClassName("text-box"),c=0;c<b.length;c++)b[c].onblur=this.updateXML.bind(this,b)},b.exports=d,b.exports.SOLVE_STATE=h},{"../game/constants.js":6,"../helper/utilities.js":15,"../html/popupWindows.js":16,"../html/questionWindows.js":17,"../menus/popup.js":19}],4:[function(a,b,c){"use strict";function d(a){this.xml=a;var b=parseInt(a.getAttribute("type"));switch(this.type=b,b){case 0:this.icon="../img/iconResourceFile.png";break;case 1:this.icon="../img/iconResourceLink.png";break;case 2:this.icon="../img/iconResourceVideo.png";break;default:this.icon=""}this.title=a.getAttribute("text"),this.link=a.getAttribute("link")}function e(a,b){for(var c=0;c<a.length;c++)this[c]=new d(a[c]);this.length=a.length,this.doc=b;var e=document.createElement("DIV");e.innerHTML=f.resourcesWindow,this.resource=e.firstChild,this.resourceDiv=this.resource.getElementsByClassName("resourceContent")[0],this.updateResources(),this.buttons=this.resource.getElementsByTagName("button")}var f=a("../html/popupWindows.js"),g=(a("../helper/utilities.js"),e.prototype);g.openWindow=function(a,b,c){var d=this;this.buttons[0].onclick=function(){a.innerHTML="",d.windowDiv=null,c()},this.buttons[1].onclick=function(){d.edit(null,function(){d.updateResources(),d.windowDiv&&d.openWindow(d.windowDiv,d.select,d.onclose)})},this.onclose=c,this.windowDiv=a,this.select=b;for(var e=this.resource.getElementsByClassName("icon"),f=0;f<e.length;f++)this.select?e[f].className="iconSelect icon":e[f].className="icon";a.innerHTML="",a.appendChild(this.resource)},g.updateResources=function(){if(0==this.length)this.resourceDiv.color="grey",this.resourceDiv.className="resourceContent center",this.resourceDiv.innerHTML="No Resources Loaded";else{var a=this;this.resourceDiv.color="",this.resourceDiv.className="resourceContent",this.resourceDiv.innerHTML="";for(var b=0;b<this.length;b++){var c=f.resource.replace("%icon%",this[b].icon);c=c.replace("%title%",this[b].title),c=c.replace("%link%",this[b].link);var d=document.createElement("DIV");d.innerHTML=c,c=d.firstChild,this.resourceDiv.appendChild(c),function(b){c.getElementsByClassName("delete")[0].onclick=function(){for(var c=b;c<a.length-1;c++)a[c]=a[c+1];delete a[--a.length],a.updateResources()},c.getElementsByClassName("edit")[0].onclick=function(){a.edit(b,function(){a.updateResources(),a.windowDiv&&a.openWindow(a.windowDiv,a.select,a.onclose)})},c.getElementsByClassName("icon")[0].onclick=function(){a.windowDiv&&a.select&&(a.windowDiv.innerHTML="",a.windowDiv=null,a.onclose(b))}}(b)}}},g.edit=function(a,b){var c=document.createElement("DIV");c.innerHTML=f.resourceEditor;var e=c.firstChild,g=(e.getElementsByTagName("form")[0],this),h=e.getElementsByTagName("select")[0],i=e.getElementsByTagName("button");null==a?e.innerHTML=e.innerHTML.replace(/%edit%/g,"Create").replace(/%apply%/g,"Create Resource").replace(/%name%/g,"").replace(/%link%/g,""):(e.innerHTML=e.innerHTML.replace(/%edit%/g,"Edit").replace(/%apply%/g,"Apply Changes").replace(/%name%/g,this[a].title).replace(/%link%/g,this[a].link),h.value=this[a].type,this.newLink=this[a].link),this.updateEditInfo(h,i,e.getElementsByClassName("addressTag")[0],e.getElementsByClassName("addressInfo")[0],e.getElementsByClassName("address")[0],a),e.getElementsByTagName("select")[0].onchange=function(){g.updateEditInfo(g.windowDiv.getElementsByTagName("select")[0],g.windowDiv.getElementsByTagName("button"),g.windowDiv.getElementsByClassName("addressTag")[0],g.windowDiv.getElementsByClassName("addressInfo")[0],g.windowDiv.getElementsByClassName("address")[0],a)},i[2].onclick=function(){g.windowDiv.innerHTML="",b()},i[3].onclick=function(){null==a&&(a=g.length++);var c=g.doc.createElement("resource"),f=e.getElementsByTagName("form")[0];if(c.setAttribute("type",f.elements.type.value),c.setAttribute("text",f.elements.name.value),null==g.newLink){var h=f.elements.link.value;h.match(/^https?:\/\/.*/)||(h="http://"+h),c.setAttribute("link",h)}else c.setAttribute("link",g.newLink);g[a]=new d(c),g.windowDiv.innerHTML="",b()},this.windowDiv.innerHTML="",this.windowDiv.appendChild(e)},g.updateEditInfo=function(a,b,c,d,e,f){if(this.newLink||(this.newLink=""),0==Number(a.value)){c.innerHTML="Refrence File",e.value="",e.type="file",e.style.display="none",d.style.display="",d.innerHTML=this.newLink,b[0].style.display="",b[1].style.display="";var g=this;b[1].onclick=function(){console.log(g.newLink),g.newLink&&""!=g.newLink&&window.open(g.newLink,"_blank")},b[0].onclick=e.click.bind(e),e.onchange=function(){if(e.files.length>0){for(var a=0;a<b.length;a++)b[a].disabled=!0;var c=new FormData;c.append("resource",e.files[0],e.files[0].name);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState&&200==f.status){for(var a=0;a<b.length;a++)b[a].disabled=!1;f.responseText.match(/^error.*/i)?d.innerHTML=f.responseText:(g.newLink=window.location.href.substr(0,window.location.href.substr(0,window.location.href.length-1).lastIndexOf("/"))+"/resource/"+f.responseText,d.innerHTML=g.newLink)}},f.open("POST","../resource.php",!0),f.send(c),d.innerHTML="Uploading..."}else g.newLink="",d.innerHTML=g.newLink}}else c.innerHTML="Link Address",e.value="",e.type="text",e.style.display="",e.value=this.newLink,this.newLink=null,e.onchange=function(){},d.style.display="none",b[0].style.display="none",b[1].style.display="none",b[0].onclick=function(){},b[1].onclick=function(){}},g.xml=function(a){var b=a.createElement("resourceList");b.setAttribute("resourceCount",this.length);for(var c=0;c<this.length;c++)b.appendChild(this[c].xml);return b},b.exports=e},{"../helper/utilities.js":15,"../html/popupWindows.js":16}],5:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,i){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style.display="none",this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.save=i,d.addCanvas(this.canvas),a.appendChild(this.canvas);var j=this;this.canvas.addEventListener("animationend",function(){j.loaded&&j.loaded()},!1),this.boardContext=b,this.nodeContext=c,this.lessonNodeArray=f,this.boardOffset=e,this.prevBoardOffset={x:0,y:0},this.zoom=h.startZoom,this.stage=0,this.lastSaveTime=0,this.lastQuestion=null,this.lastQuestionNum=-1;for(var k=!0,l=0;l<this.lessonNodeArray.length&&k;l++)this.lessonNodeArray[l].question.currentState!=g.SOLVE_STATE.SOLVED&&(k=!1);k?this.finished=!0:this.finished=!1}var e=a("../helper/utilities.js"),f=a("../helper/point.js"),g=a("../case/question.js"),h=a("./constants.js"),i=a("../helper/drawlib.js"),j=d.prototype;j.act=function(a,b,c){if(b){if(!b.mouseDown&&this.target&&(this.target.dragPosition=void 0,this.target.dragging=!1,this.target=null),b.mouseDown){var d=this.boardContext.getBoundingClientRect();(d.left>=b.mousePosition.x||d.right<=b.mousePosition.x||d.top>=b.mousePosition.y||d.bottom<=b.mousePosition.y)&&(this.boardContext.style.display=""),d=this.nodeContext.getBoundingClientRect(),(d.left>=b.mousePosition.x||d.right<=b.mousePosition.x||d.top>=b.mousePosition.y||d.bottom<=b.mousePosition.y)&&(this.nodeContext.style.display="")}for(var g=this.lessonNodeArray.length-1;g>=0&&null==this.target;g--){var i=this.lessonNodeArray[g];i.mouseOver=!1,e.mouseIntersect(b,i,this.boardOffset)&&(i.mouseOver=!0,this.target=i)}if(this.addCon)b.mouseClicked&&(this.addCon=!1,this.target&&this.target!=this.startCon&&(this.subConnection(this.target.question,this.startCon.question)||(this.target.question.revealThreshold++,this.startCon.question.connections.push(this.target.question.num+1),this.save()))),null==this.target&&(this.canvas.style.cursor="crosshair");else if(this.hideCon){if(b.mouseClicked&&(this.hideCon=!1,this.target&&this.target!=this.startCon)){for(var j=0,g=0;g<this.startCon.question.connections.length&&0==j;g++)this.lessonNodeArray[Math.abs(this.startCon.question.connections[g])-1]==this.target&&(j=this.startCon.question.connections[g]);0!=j&&(console.log(j),this.startCon.question.connections.splice(this.startCon.question.connections.indexOf(j),1),this.startCon.question.connections.push(-j),this.save())}null==this.target&&(this.canvas.style.cursor="crosshair")}else if(this.removeCon){if(b.mouseClicked&&(this.removeCon=!1,this.target&&this.target!=this.startCon&&confirm("Are you sure you want to remove this connection? This action can't be undone!"))){for(var j=-1,g=0;g<this.startCon.question.connections.length&&-1==j;g++)this.lessonNodeArray[this.startCon.question.connections[g]-1]==this.target&&(j=this.startCon.question.connections[g]);j>=0&&(this.target.question.revealThreshold--,this.startCon.question.connections.splice(this.startCon.question.connections.indexOf(j),1),this.save())}null==this.target&&(this.canvas.style.cursor="crosshair")}else if(this.target)if(this.target.dragging){var k=b.virtualPosition.x-this.target.dragPosition.x;this.target.position.x=Math.max(h.boardOutline,Math.min(k,h.boardSize.x-h.boardOutline));var l=b.virtualPosition.y-this.target.dragPosition.y;this.target.position.y=Math.max(h.boardOutline,Math.min(l,h.boardSize.y-h.boardOutline))}else b.mouseDown&&(this.target.dragging=!0,this.target.dragPosition=new f(b.virtualPosition.x-this.target.position.x,b.virtualPosition.y-this.target.position.y)),b.mouseClicked&&(this.target.click(b),this.lastQuestion=this.target.question),b.leftMouseClicked()&&(this.nodeContext.style.top=b.mousePosition.y+"px",this.nodeContext.style.left=b.mousePosition.x+"px",this.nodeContext.style.display="block",this.nodeContext.virtualPosition=b.virtualPosition,this.boardContext.style.display="",this.contextNode=this.target);else b.mouseDown?(this.canvas.style.cursor="-webkit-grabbing",this.canvas.style.cursor="-moz-grabbing",this.canvas.style.cursor="grabbing",this.mouseStartDragBoard?(this.boardOffset.x=this.prevBoardOffset.x-(b.virtualPosition.x-this.mouseStartDragBoard.x),this.boardOffset.x>this.maxBoardWidth/2&&(this.boardOffset.x=this.maxBoardWidth/2),this.boardOffset.x<-1*this.maxBoardWidth/2&&(this.boardOffset.x=-1*this.maxBoardWidth/2),this.boardOffset.y=this.prevBoardOffset.y-(b.virtualPosition.y-this.mouseStartDragBoard.y),this.boardOffset.y>this.maxBoardHeight/2&&(this.boardOffset.y=this.maxBoardHeight/2),this.boardOffset.y<-1*this.maxBoardHeight/2&&(this.boardOffset.y=-1*this.maxBoardHeight/2)):(this.mouseStartDragBoard=b.virtualPosition,this.prevBoardOffset.x=this.boardOffset.x,this.prevBoardOffset.y=this.boardOffset.y)):(this.mouseStartDragBoard=void 0,this.canvas.style.cursor="",b.leftMouseClicked()&&(this.boardContext.style.top=b.mousePosition.y+"px",this.boardContext.style.left=b.mousePosition.x+"px",this.boardContext.style.display="block",this.boardContext.virtualPosition=b.virtualPosition,this.nodeContext.style.display=""))}},j.subConnection=function(a,b){for(var c=!1,d=0;d<a.connections.length&&!c;d++){var e=this.lessonNodeArray[a.connections[d]-1].question;c=e==b?!0:this.subConnection(e,b)}return c},j.draw=function(a,b){this.ctx.save(),i.rect(this.ctx,0,0,this.canvas.width,this.canvas.height,"#15718F"),this.ctx.save(),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.scale(a,a),this.ctx.translate(-this.canvas.width/2,-this.canvas.height/2),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.scale(this.zoom,this.zoom),this.ctx.translate(-this.canvas.width/2,-this.canvas.height/2),this.ctx.translate(this.canvas.width/2-this.boardOffset.x,this.canvas.height/2-this.boardOffset.y),i.rect(this.ctx,0,0,h.boardSize.x,h.boardSize.y,"#D3B185"),i.strokeRect(this.ctx,-h.boardOutline/2,-h.boardOutline/2,h.boardSize.x+h.boardOutline/2,h.boardSize.y+h.boardOutline/2,h.boardOutline,"#CB9966");for(var c=0;c<this.lessonNodeArray.length;c++)this.lessonNodeArray[c].draw(this.ctx,this.canvas);for(var c=0;c<this.lessonNodeArray.length;c++)for(var d=this.lessonNodeArray[c].getNodePoint(),e=0;e<this.lessonNodeArray[c].question.connections.length;e++){var g=this.lessonNodeArray[Math.abs(this.lessonNodeArray[c].question.connections[e])-1],j="rgba(255, 0, 0, ",k=h.arrowSize;(!this.removeCon&&!this.hideCon&&this.lessonNodeArray[c]==this.target||(this.removeCon||this.hideCon)&&this.lessonNodeArray[c]==this.startCon&&g==this.target)&&(k*=2,j="rgba(0, 0, 255, "),j+=this.lessonNodeArray[c].question.connections[e]<0?"0.25)":"1)";var l=g.getNodePoint();i.arrow(this.ctx,d,l,h.arrowHeadSize,k,j)}this.addCon&&i.arrow(this.ctx,this.startCon.getNodePoint(),new f(b.virtualPosition.x+this.boardOffset.x,b.virtualPosition.y+this.boardOffset.y),h.arrowHeadSize,h.arrowSize,"darkRed"),this.ctx.restore()},j.getFreeNode=function(){for(var a=0;a<this.lessonNodeArray.length;a++)if(this.lessonNodeArray[a].currentState==g.SOLVE_STATE.UNSOLVED)return this.lessonNodeArray[a];return null},j.moveTowards=function(a,b,c){var d=new f(a.x-this.boardOffset.x,a.y-this.boardOffset.y),e=Math.sqrt(d.x*d.x+d.y*d.y),g=new f(this.boardOffset.x+d.x/e*b*c,this.boardOffset.y+d.y/e*b*c);this.boardOffset.x!=a.x&&Math.abs(a.x-g.x)/(a.x-g.x)==Math.abs(a.x-this.boardOffset.x)/(a.x-this.boardOffset.x)?this.boardOffset.x=g.x:this.boardOffset.x=a.x,this.boardOffset.y!=a.y&&Math.abs(a.y-g.y)/(a.y-g.y)==Math.abs(a.y-this.boardOffset.y)/(a.y-this.boardOffset.y)?this.boardOffset.y=g.y:this.boardOffset.y=a.y},j.windowClosed=function(){var a;if(this.lastQuestion){var b=this.lastQuestion;if(this.lastQuestion=null,b.save){b.save=!1,a=b.xml;for(var c=0;c<this.lessonNodeArray.length;c++)this.lessonNodeArray[c].updateImage()}return{xml:a,num:b.num}}return null},j.addConnection=function(a){this.addCon=!0,this.canvas.style.cursor="crosshair",this.startCon=a},j.removeConnection=function(a){this.removeCon=!0,this.canvas.style.cursor="crosshair",this.startCon=a},j.hideConnection=function(a){this.hideCon=!0,this.canvas.style.cursor="crosshair",this.startCon=a},j.show=function(a){null!=a&&(this.canvas.style.animation="canvasEnter"+(a?"L":"R")+" 1s"),this.canvas.style.display="inline-block"},j.hide=function(a){if(null!=a){this.canvas.style.animation="canvasLeave"+(a?"R":"L")+" 1s";var b=this;this.loaded=function(){b.canvas.style.display="none"}}else b.canvas.style.display="none"},j.updateSize=function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight},b.exports=d},{"../case/question.js":3,"../helper/drawlib.js":9,"../helper/point.js":14,"../helper/utilities.js":15,"./constants.js":6}],6:[function(a,b,c){"use strict";var d=a("../helper/point.js"),e=b.exports;e.boardSize=new d(1920,1080),e.boundSize=3,e.boardOutline=e.boardSize.x>e.boardSize.y?e.boardSize.x/20:e.boardSize.y/20,e.startZoom=.5,e.endZoom=1.5,e.zoomSpeed=.001,e.zoomMoveSpeed=.75,e.lineSpeed=.002,e.pinchSpeed=.0025,e.nodeStep=.1,e.maxNodeScale=2,e.minNodeScale=.5,e.nodeEdgeWidth=25,e.arrowHeadSize=50,e.arrowSize=5},{"../helper/point.js":14}],7:[function(a,b,c){"use strict";function d(a,b){var c=this;this.active=!1,this.section=a,this.saveFiles=[],f=document.getElementById("window"),g=document.getElementById("windowFlim"),e=document.querySelector("#"+a.id+" #zoom-slider"),e.oninput=function(){c.setZoom(-parseFloat(e.value))},document.querySelector("#"+a.id+" #zoom-in").onclick=function(){e.stepDown(),c.setZoom(-parseFloat(e.value))},document.querySelector("#"+a.id+" #zoom-out").onclick=function(){e.stepUp(),c.setZoom(-parseFloat(e.value))};var d=document.querySelector("#"+a.id+" #board-context");document.querySelector("#"+a.id+" #board-context #add-question").onclick=function(a){c.boardArray[c.activeBoardIndex];c.addQuestion((d.virtualPosition.x+l.boardSize.x/2)/l.boardSize.x*100,(d.virtualPosition.y+l.boardSize.y/2)/l.boardSize.y*100),d.style.display=""},document.querySelector("#"+a.id+" #board-context #add-category").onclick=function(a){s.prompt(f,"Create Category","Category Name:","","Create",function(a){a&&c.addCategory(a)}),d.style.display=""},document.querySelector("#"+a.id+" #board-context #rename-category").onclick=function(a){s.prompt(f,"Rename Category","Category Name:",c.categories[c.activeBoardIndex].name,"Rename",function(a){if(a){c.categories[c.activeBoardIndex].name=a,c.boardArray[c.activeBoardIndex].button.innerHTML=a;var b=JSON.parse(localStorage.caseDataCreate),d=p.getXml(b.caseFile);d.getElementsByTagName("categoryList")[0].getElementsByTagName("element")[c.activeBoardIndex].innerHTML=a,b.caseFile=(new XMLSerializer).serializeToString(d),localStorage.caseDataCreate=JSON.stringify(b)}}),d.style.display=""},document.querySelector("#"+a.id+" #board-context #delete-category").onclick=function(a){c.boardArray.length>1&&confirm("Are you sure you want to delete the current category You can't undo this action!")&&c.deleteCategory(),d.style.display=""},document.querySelector("#"+a.id+" #board-context #forward-category").onclick=function(a){c.activeBoardIndex+1<c.categories.length&&c.moveCategory(1),d.style.display=""},document.querySelector("#"+a.id+" #board-context #backward-category").onclick=function(a){c.activeBoardIndex-1>=0&&c.moveCategory(-1),d.style.display=""},document.querySelector("#"+a.id+" #board-context #edit-info").onclick=function(a){var b=JSON.parse(localStorage.caseDataCreate);s.editInfo(f,p.getXml(b.caseFile),function(a,c){localStorage.caseName=c+".ipar",b=JSON.parse(localStorage.caseDataCreate),b.caseFile=(new XMLSerializer).serializeToString(a),localStorage.caseDataCreate=JSON.stringify(b)}),d.style.display=""},document.querySelector("#"+a.id+" #board-context #edit-resources").onclick=function(a){c.resources.openWindow(f,!1,function(){var a=JSON.parse(localStorage.caseDataCreate),b=p.getXml(a.caseFile),d=b.getElementsByTagName("resourceList")[0];d.parentNode.replaceChild(c.resources.xml(b),d),a.caseFile=(new XMLSerializer).serializeToString(b),localStorage.caseDataCreate=JSON.stringify(a),c.save()}),d.style.display=""};var h=document.querySelector("#"+this.section.id+" #node-context");document.querySelector("#"+a.id+" #node-context #add-connection").onclick=function(a){c.boardArray[c.activeBoardIndex].addConnection(c.boardArray[c.activeBoardIndex].contextNode),c.save(),h.style.display=""},document.querySelector("#"+a.id+" #node-context #hide-connection").onclick=function(a){c.boardArray[c.activeBoardIndex].contextNode.question.connections.length>0&&(c.boardArray[c.activeBoardIndex].hideConnection(c.boardArray[c.activeBoardIndex].contextNode),c.save()),h.style.display=""},document.querySelector("#"+a.id+" #node-context #remove-connection").onclick=function(a){c.boardArray[c.activeBoardIndex].contextNode.question.connections.length>0&&(c.boardArray[c.activeBoardIndex].removeConnection(c.boardArray[c.activeBoardIndex].contextNode),c.save()),h.style.display=""},document.querySelector("#"+a.id+" #node-context #delete-question").onclick=function(a){if(confirm("Are you sure want to delete this question? You can't undo this action!")){for(var b=c.boardArray[c.activeBoardIndex],d=c.categories[c.activeBoardIndex],e=0;e<d.questions.length;e++){
d.questions[e].num>b.contextNode.question.num&&d.questions[e].num--;for(var f=d.questions[e].connections.indexOf(b.contextNode.question.num+1);-1!=f;)d.questions[e].connections.splice(f,1),f=d.questions[e].connections.indexOf(b.contextNode.question.num+1);for(var g=0;g<d.questions[e].connections.length;g++)d.questions[e].connections[g]-1>b.contextNode.question.num&&d.questions[e].connections[g]--}b.lessonNodeArray.splice(b.contextNode.question.num,1),d.questions.splice(b.contextNode.question.num,1),c.save()}h.style.display=""},document.querySelector("#"+a.id+" #node-context #make-larger").onclick=function(a){var b=c.boardArray[c.activeBoardIndex];b.lessonNodeArray[b.contextNode.question.num].question.scale<l.maxNodeScale&&(b.lessonNodeArray[b.contextNode.question.num].question.scale+=l.nodeStep,b.lessonNodeArray[b.contextNode.question.num].updateImage()),c.save(),h.style.display=""},document.querySelector("#"+a.id+" #node-context #make-smaller").onclick=function(a){var b=c.boardArray[c.activeBoardIndex];b.lessonNodeArray[b.contextNode.question.num].question.scale>l.minNodeScale&&(b.lessonNodeArray[b.contextNode.question.num].question.scale-=l.nodeStep,b.lessonNodeArray[b.contextNode.question.num].updateImage()),c.save(),h.style.display=""},this.scale=b;var i=o.loadCase(JSON.parse(localStorage.caseDataCreate),document.querySelector("#"+a.id+" #window"));this.resources=i.resources,this.categories=i.categories,this.nodeContext=h,this.boardContext=d,this.createLessonNodes(),this.activeBoardIndex=i.category,this.active=!0,this.boardArray[this.activeBoardIndex].show(),this.boardArray[this.activeBoardIndex].button.className="active",e.value=-this.getZoom(),o.prepareZip(document.querySelector("#"+a.id+" #blob"));var j=document.createElement("DIV");j.innerHTML=t.imagesEditor,this.imagesWindow=j.firstChild;for(var k=this.imagesWindow.getElementsByClassName("imageContent")[0],m=0;m<i.images.length;m++)k.innerHTML+=t.image.replace(/%image%/g,i.images[m]);for(var m=0;m<this.categories.length;m++)for(var n=0;n<this.categories[m].questions.length;n++)this.categories[m].questions[n].imagesWindow=this.imagesWindow}var e,f,g,h,i=a("./board.js"),j=a("../helper/point.js"),k=a("./lessonNode.js"),l=a("./constants.js"),m=(a("../helper/drawlib.js"),a("../helper/iparDataParser.js"),a("../helper/mouseState.js")),n=a("../helper/keyboardState.js"),o=a("../helper/fileManager.js"),p=a("../helper/utilities.js"),q=a("../case/question.js"),r=a("../case/category.js"),s=a("../menus/popup.js"),t=a("../html/popupWindows.js"),u=0,v=d.prototype;v.addCategory=function(a){var b=JSON.parse(localStorage.caseDataCreate),c=p.getXml(b.caseFile),d=c.createElement("category");d.setAttribute("categoryDesignation",this.categories.length),d.setAttribute("questionCount",0),c.getElementsByTagName("case")[0].appendChild(d),this.categories.push(new r(a,d,this.resources,f)),this.createBoard(this.categories[this.categories.length-1],this.categories.length-1),c.getElementsByTagName("case")[0].appendChild(d);var e=c.getElementsByTagName("categoryList")[0];e.setAttribute("categoryCount",this.categories.length);var g=c.createElement("element");g.innerHTML=a,e.appendChild(g),b.caseFile=(new XMLSerializer).serializeToString(c),localStorage.caseDataCreate=JSON.stringify(b)},v.moveCategory=function(a){var b=this.categories[this.activeBoardIndex];this.categories[this.activeBoardIndex]=this.categories[a+this.activeBoardIndex],this.categories[this.activeBoardIndex+a]=b,this.boardArray[this.activeBoardIndex].button.innerHTML=this.categories[this.activeBoardIndex].name,this.boardArray[this.activeBoardIndex+a].button.innerHTML=this.categories[this.activeBoardIndex+a].name,b=this.boardArray[this.activeBoardIndex+a].button,this.boardArray[this.activeBoardIndex+a].button=this.boardArray[this.activeBoardIndex].button,this.boardArray[this.activeBoardIndex].button=b,b=this.boardArray[this.activeBoardIndex+a],this.boardArray[this.activeBoardIndex+a]=this.boardArray[this.activeBoardIndex],this.boardArray[this.activeBoardIndex]=b;var c=JSON.parse(localStorage.caseDataCreate),d=p.getXml(c.caseFile),e=d.getElementsByTagName("categoryList")[0].getElementsByTagName("element");e[this.activeBoardIndex].innerHTML=this.categories[this.activeBoardIndex].name,e[this.activeBoardIndex+a].innerHTML=this.categories[this.activeBoardIndex+a].name;for(var f=d.getElementsByTagName("category"),g=0;g<f.length;g++)Number(f[g].getAttribute("categoryDesignation"))==this.activeBoardIndex?f[g].setAttribute("categoryDesignation",this.activeBoardIndex+a):Number(f[g].getAttribute("categoryDesignation"))==this.activeBoardIndex+a&&f[g].setAttribute("categoryDesignation",this.activeBoardIndex);c.caseFile=(new XMLSerializer).serializeToString(d),localStorage.caseDataCreate=JSON.stringify(c),this.boardArray[this.activeBoardIndex+a].button.className="active",this.boardArray[this.activeBoardIndex].button.className="",this.activeBoardIndex+=a},v.deleteCategory=function(){this.boardArray[this.boardArray.length-1].button.parentNode.removeChild(this.boardArray[this.boardArray.length-1].button),this.boardArray[this.activeBoardIndex].canvas.parentNode.removeChild(this.boardArray[this.activeBoardIndex].canvas);for(var a=this.boardArray.length-1;a>this.activeBoardIndex;a--)this.boardArray[a].button=this.boardArray[a-1].button,this.boardArray[a].button.innerHTML=this.categories[a].name;for(var a=this.activeBoardIndex+1;a<this.boardArray.length;a++)this.boardArray[a-1]=this.boardArray[a],this.categories[a-1]=this.categories[a];this.boardArray.pop(),this.categories.pop();var b=JSON.parse(localStorage.caseDataCreate),c=p.getXml(b.caseFile),d=c.getElementsByTagName("categoryList")[0];d.setAttribute("categoryCount",this.categories.length),d.removeChild(d.getElementsByTagName("element")[this.activeBoardIndex]);for(var e=c.getElementsByTagName("category"),a=0;a<e.length;a++)if(Number(e[a].getAttribute("categoryDesignation"))==this.activeBoardIndex){e[a].parentNode.removeChild(e[a]);break}e=c.getElementsByTagName("category");for(var a=0;a<e.length;a++)Number(e[a].getAttribute("categoryDesignation"))>this.activeBoardIndex&&e[a].setAttribute("categoryDesignation",this.activeBoardIndex-1);b.caseFile=(new XMLSerializer).serializeToString(c),localStorage.caseDataCreate=JSON.stringify(b),this.activeBoardIndex>=this.boardArray.length&&(this.activeBoardIndex=this.boardArray.length-1),this.boardArray[this.activeBoardIndex].button.className="active",this.newBoard=this.activeBoardIndex,this.zoomout=!0},v.createLessonNodes=function(){this.boardArray=[],this.bottomBar=document.querySelector("#"+this.section.id+" #bottomBar"),this.mouseState=new m,this.keyboardState=new n(this);for(var a=0;a<this.categories.length;a++)this.createBoard(this.categories[a],a)},v.createBoard=function(a,b){this.lessonNodes=[];for(var c=0;c<a.questions.length;c++)this.lessonNodes.push(new k(a.questions[c])),this.lessonNodes[this.lessonNodes.length-1].question=a.questions[c];this.boardArray[b]=new i(this.section,this.boardContext,this.nodeContext,this.mouseState,new j(l.boardSize.x/2,l.boardSize.y/2),this.lessonNodes,this.save.bind(this));var d=document.createElement("BUTTON");d.innerHTML=a.name;var e=this;d.onclick=function(a){return function(){e.active&&e.changeBoard(a)}}(b),this.bottomBar.appendChild(d),this.boardArray[b].button=d},v.update=function(a){this.active?(this.act(a),this.boardArray[this.activeBoardIndex].draw(this.scale,this.mouseState)):0!=u&&""==f.innerHTML&&this.windowClosed()},v.act=function(a){if(this.mouseState.update(a,this.scale*this.getZoom()),this.keyboardState.update(),this.checkKeyboard(),this.boardArray[this.activeBoardIndex].act(this.scale,this.zoomout?null:this.mouseState,a),this.activeBoardIndex<this.boardArray.length-1&&this.boardArray[this.activeBoardIndex+1].button.disabled&&this.boardArray[this.activeBoardIndex].finished&&(this.boardArray[this.activeBoardIndex+1].button.disabled=!1),this.zoomout){var b=this.boardArray[this.activeBoardIndex];if(this.getZoom()>l.startZoom?b.zoom-=a*l.zoomSpeed:this.getZoom()<l.startZoom&&(b.zoom=l.startZoom),b.moveTowards(new j(l.boardSize.x/2,l.boardSize.y/2),a,l.zoomMoveSpeed),e.value=-this.getZoom(),this.getZoom()==l.startZoom&&b.boardOffset.x==l.boardSize.x/2&&b.boardOffset.y==l.boardSize.y/2&&(this.zoomout=!1,null!=this.newBoard)){var c=this.newBoard<this.activeBoardIndex;this.boardArray[this.activeBoardIndex].hide(c),this.activeBoardIndex=this.newBoard,this.boardArray[this.activeBoardIndex].show(c),e.value=-this.getZoom(),this.active=!1;var d=this;this.boardArray[this.activeBoardIndex].loaded=function(){d.active=!0,d.newBoard=null}}}else 0!=this.mouseState.zoomDiff?(e.value=h+this.mouseState.zoomDiff*l.pinchSpeed,this.updateZoom(-parseFloat(e.value))):h=Number(e.value),0!=this.mouseState.mouseWheelDY&&this.zoom(this.mouseState.mouseWheelDY<0);""!=f.innerHTML&&u++>3&&(this.active=!1,g.style.display="block")},v.getZoom=function(){return this.boardArray[this.activeBoardIndex].zoom},v.setZoom=function(a){this.boardArray[this.activeBoardIndex].zoom=a},v.zoom=function(a){a?e.stepDown():e.stepUp(),this.setZoom(-parseFloat(e.value))},v.setScale=function(a){for(var b=0;b<this.boardArray.length;b++)this.boardArray[b].updateSize();this.scale=a},v.changeBoard=function(a){a!=this.activeBoardIndex&&(this.boardArray[a].button.className="active",this.boardArray[this.activeBoardIndex].button.className="",this.newBoard=a,this.zoomout=!0)},v.windowClosed=function(){u=0,this.active=!0,g.style.display="none";var a=this.boardArray[this.activeBoardIndex].windowClosed();if(a){var b=JSON.parse(localStorage.caseDataCreate),c=p.getXml(b.caseFile);if(a.xml){var d=c.getElementsByTagName("category")[this.activeBoardIndex];d.replaceChild(a.xml,d.getElementsByTagName("button")[a.num]),b.caseFile=(new XMLSerializer).serializeToString(c),localStorage.caseDataCreate=JSON.stringify(b)}else this.categories[this.activeBoardIndex].questions[a.num].xml=c.getElementsByTagName("category")[this.activeBoardIndex].getElementsByTagName("button")[a.num],this.categories[this.activeBoardIndex].questions[a.num].refresh()}this.save()},v.save=function(){for(var a=this.boardArray[this.activeBoardIndex].lessonNodeArray,b=0;b<a.length;b++)a[b].save();for(var c=JSON.parse(localStorage.caseDataCreate),d=p.getXml(c.caseFile),e=d.getElementsByTagName("case")[0],f=e.getElementsByTagName("category")[0];f;)e.removeChild(f),f=e.getElementsByTagName("category")[0];for(var b=0;b<this.categories.length;b++)e.appendChild(this.categories[b].xml(d,b));c.caseFile=(new XMLSerializer).serializeToString(d),localStorage.caseDataCreate=JSON.stringify(c)},v.addQuestion=function(a,b){var c=JSON.parse(localStorage.caseDataCreate),d=p.getXml(c.caseFile),e=d.createElement("button");e.setAttribute("xPositionPercent",a),e.setAttribute("yPositionPercent",b),e.setAttribute("scale","1"),e.setAttribute("numConnections","0"),e.setAttribute("numAnswers","3"),e.setAttribute("correctAnswer","0"),e.setAttribute("imageLink",window.location.href.substr(0,window.location.href.substr(0,window.location.href.length-1).lastIndexOf("/"))+"/image/eb1832a80fa41e395491571d4930119b.png"),e.setAttribute("revealThreshold","0"),e.setAttribute("questionType","2"),e.setAttribute("resourceCount","0"),e.appendChild(d.createElement("questionName")),e.appendChild(d.createElement("instructions")),e.appendChild(d.createElement("questionText")),e.appendChild(d.createElement("answer")),e.appendChild(d.createElement("answer")),e.appendChild(d.createElement("answer")),e.appendChild(d.createElement("feedback")),e.appendChild(d.createElement("feedback")),e.appendChild(d.createElement("feedback"));for(var g=d.getElementsByTagName("category"),h=0;h<g.length;h++)if(Number(g[h].getAttribute("categoryDesignation"))==this.activeBoardIndex){g[h].appendChild(e);break}var i=new q(e,this.resources,f,this.categories[this.activeBoardIndex].questions.length);i.imagesWindow=this.imagesWindow,this.categories[this.activeBoardIndex].questions.push(i);var j=this.boardArray[this.activeBoardIndex].lessonNodeArray;j.push(new k(i)),j[j.length-1].question=i,this.boardArray[this.activeBoardIndex].lessonNodeArray=j,this.save()},v.checkKeyboard=function(){if(this.keyboardState.keyPressed[46]&&this.boardArray.length>1&&confirm("Are you sure you want to delete the current category You can't undo this action!")&&this.deleteCategory(),this.keyboardState.key[17]){var a=this.boardArray[this.activeBoardIndex],b=this;if(this.keyboardState.keyPressed[67]&&s.prompt(f,"Create Category","Category Name:","","Create",function(a){a&&b.addCategory(a)}),this.keyboardState.keyPressed[86]&&s.prompt(f,"Rename Category","Category Name:",this.categories[this.activeBoardIndex].name,"Rename",function(a){if(a){b.categories[b.activeBoardIndex].name=a,b.boardArray[b.activeBoardIndex].button.innerHTML=a;var c=JSON.parse(localStorage.caseDataCreate),d=p.getXml(c.caseFile);d.getElementsByTagName("categoryList")[0].getElementsByTagName("element")[b.activeBoardIndex].innerHTML=a,c.caseFile=(new XMLSerializer).serializeToString(d),localStorage.caseDataCreate=JSON.stringify(c)}}),this.keyboardState.keyPressed[88]&&this.activeBoardIndex+1<this.categories.length&&this.moveCategory(1),this.keyboardState.keyPressed[90]&&this.activeBoardIndex-1>=0&&this.moveCategory(-1),this.keyboardState.keyPressed[70]){var c=JSON.parse(localStorage.caseDataCreate);s.editInfo(f,p.getXml(c.caseFile),function(a,b){localStorage.caseName=b+".ipar",c=JSON.parse(localStorage.caseDataCreate),c.caseFile=(new XMLSerializer).serializeToString(a),localStorage.caseDataCreate=JSON.stringify(c)})}if(this.keyboardState.keyPressed[82]&&this.resources.openWindow(f,!1,function(){var a=JSON.parse(localStorage.caseDataCreate),c=p.getXml(a.caseFile),d=c.getElementsByTagName("resourceList")[0];d.parentNode.replaceChild(b.resources.xml(c),d),a.caseFile=(new XMLSerializer).serializeToString(c),localStorage.caseDataCreate=JSON.stringify(a),b.save()}),a.target){if(this.keyboardState.key[16])this.keyboardState.keyPressed[65]&&(a.addConnection(a.target),this.save()),this.keyboardState.keyPressed[68]&&a.target.question.connections.length>0&&(a.removeConnection(a.target),this.save()),this.keyboardState.keyPressed[83]&&b.boardArray[b.activeBoardIndex].contextNode.question.connections.length>0&&(b.boardArray[b.activeBoardIndex].hideConnection(b.boardArray[b.activeBoardIndex].contextNode),b.save());else if(this.keyboardState.keyPressed[65]&&(a.lessonNodeArray[a.target.question.num].question.scale>l.minNodeScale&&(a.lessonNodeArray[a.target.question.num].question.scale-=l.nodeStep,a.lessonNodeArray[a.target.question.num].updateImage()),this.save()),this.keyboardState.keyPressed[83]&&(a.lessonNodeArray[a.target.question.num].question.scale<l.maxNodeScale&&(a.lessonNodeArray[a.target.question.num].question.scale+=l.nodeStep,a.lessonNodeArray[a.target.question.num].updateImage()),this.save()),this.keyboardState.keyPressed[68]&&confirm("Are you sure want to delete this question? You can't undo this action!")){for(var d=this.categories[this.activeBoardIndex],e=0;e<d.questions.length;e++){d.questions[e].num>a.target.question.num&&d.questions[e].num--;for(var g=d.questions[e].connections.indexOf(a.target.question.num+1);-1!=g;)d.questions[e].connections.splice(g,1),g=d.questions[e].connections.indexOf(a.target.question.num+1);for(var h=0;h<d.questions[e].connections.length;h++)d.questions[e].connections[h]-1>a.target.question.num&&d.questions[e].connections[h]--}a.lessonNodeArray.splice(a.target.question.num,1),d.questions.splice(a.target.question.num,1),this.save()}}else this.keyboardState.keyPressed[81]&&this.addQuestion((this.mouseState.virtualPosition.x+l.boardSize.x/2)/l.boardSize.x*100,(this.mouseState.virtualPosition.y+l.boardSize.y/2)/l.boardSize.y*100)}},b.exports=d},{"../case/category.js":2,"../case/question.js":3,"../helper/drawlib.js":9,"../helper/fileManager.js":10,"../helper/iparDataParser.js":11,"../helper/keyboardState.js":12,"../helper/mouseState.js":13,"../helper/point.js":14,"../helper/utilities.js":15,"../html/popupWindows.js":16,"../menus/popup.js":19,"./board.js":5,"./constants.js":6,"./lessonNode.js":8}],8:[function(a,b,c){"use strict";function d(a){this.position=new g(a.positionPercentX/100*f.boardSize.x,a.positionPercentY/100*f.boardSize.y),this.dragLocation=void 0,this.mouseOver=!1,this.dragging=!1,this.type="lessonNode",this.image=new Image,this.check=new Image,this.width,this.height,this.question=a,this.connections=0,this.currentState=0,this.linePercent=0,a.currentState==e.SOLVE_STATE.SOLVED&&(this.linePercent=1);var b=this;this.image.onload=function(){b.width=b.image.naturalWidth,b.height=b.image.naturalHeight;var a=f.boardSize.x/10;if(b.width<a&&b.height<a){var c;c=b.width>b.height?a/b.width:a/b.height,b.width=b.width*c*b.question.scale,b.height=b.height*c*b.question.scale}if(b.width>a||b.height>a){var c;c=b.width>b.height?b.width/a:b.height/a,b.width=b.width/c*b.question.scale,b.height=b.height/c*b.question.scale}},this.image.src=this.question.imageLink,this.check.src=h}var e=(a("../helper/drawlib.js"),a("../case/question.js")),f=a("./constants.js"),g=a("../helper/point.js"),h="../img/iconPostItCheck.png",i=d.prototype;i.draw=function(a,b){a.save(),this.dragging?(a.shadowColor="yellow",a.shadowBlur=5,b.style.cursor="-webkit-grabbing",b.style.cursor="-moz-grabbing",b.style.cursor="grabbing"):this.mouseOver&&(a.shadowColor="dodgerBlue",a.shadowBlur=5,b.style.cursor="pointer"),a.drawImage(this.image,this.position.x-this.width/2,this.position.y-this.height/2,this.width,this.height),a.fillStyle="blue",a.strokeStyle="cyan";var c=this.width<this.height?this.width:this.height;a.lineWidth=c/32,a.beginPath();var d=this.getNodePoint();a.arc(d.x,d.y,3*c/32,0,2*Math.PI),a.closePath(),a.fill(),a.stroke(),a.restore()},i.getNodePoint=function(){var a=this.width<this.height?this.width:this.height;return new g(this.position.x-this.width/2+3*a/16,this.position.y-this.height/2+3*a/16)},i.click=function(a){this.question.displayWindows()},i.updateImage=function(){this.image.src=this.question.imageLink},i.save=function(){this.question.positionPercentX=this.position.x/f.boardSize.x*100,this.question.positionPercentY=this.position.y/f.boardSize.y*100,this.question.saveXML()},b.exports=d},{"../case/question.js":3,"../helper/drawlib.js":9,"../helper/point.js":14,"./constants.js":6}],9:[function(a,b,c){"use strict";var d=b.exports;d.clear=function(a,b,c,d,e){a.clearRect(b,c,d,e)},d.rect=function(a,b,c,d,e,f,g){a.save(),a.fillStyle=f,g?a.fillRect(b-d/2,c-e/2,d,e):a.fillRect(b,c,d,e),a.restore()},d.strokeRect=function(a,b,c,d,e,f,g,h){a.save(),a.strokeStyle=g,a.lineWidth=f,h?a.strokeRect(b-d/2,c-e/2,d,e):a.strokeRect(b,c,d,e),a.restore()},d.line=function(a,b,c,d,e,f,g){a.save(),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.lineWidth=f,a.strokeStyle=g,a.stroke(),a.restore()},d.circle=function(a,b,c,d,e){a.save(),a.beginPath(),a.arc(b,c,d,0,2*Math.PI,!1),a.fillStyle=e,a.fill(),a.restore()},d.arrow=function(a,b,c,d,e,f){var g=Math.atan2(c.y-b.y,c.x-b.x);a.save(),a.beginPath(),a.moveTo(b.x,b.y),a.lineTo(c.x,c.y),a.lineTo(c.x-d*Math.cos(g-Math.PI/6),c.y-d*Math.sin(g-Math.PI/6)),a.moveTo(c.x,c.y),a.lineTo(c.x-d*Math.cos(g+Math.PI/6),c.y-d*Math.sin(g+Math.PI/6)),a.closePath(),a.lineWidth=e,a.strokeStyle=f,a.stroke(),a.restore()}},{}],10:[function(a,b,c){"use strict";function d(){var a=JSON.parse(localStorage.caseDataCreate),b=new JSZip;b.file("caseFile.ipardata",a.caseFile),b.file("saveFile.ipardata",a.saveFile);var c=b.folder("submitted");for(var d in a.submitted)if(a.submitted.hasOwnProperty(d)){var e=a.submitted[d].indexOf("base64,")+"base64,".length;c.file(d,a.submitted[d].substr(e),{base64:!0})}b.generateAsync({type:"base64"}).then(function(a){var b=document.createElement("a");b.style.display="none",b.href="data:application/zip;base64,"+a,b.download=localStorage.caseName,document.body.appendChild(b),b.click(),document.body.removeChild(b)})}var e=(a("../case/category.js"),a("../case/resources.js"),a("./utilities.js")),f=a("./iparDataParser.js"),g=b.exports;g.loadCase=function(a,b){this.categories=[],this.questions=[];for(var c=e.getXml(a.caseFile),d=f.getResources(c),g=f.getCategoriesAndQuestions(c,d,b),h=[],i=0;i<g.length;i++)for(var j=0;j<g[i].questions.length;j++)-1==h.indexOf(g[i].questions[j].imageLink)&&h.push(g[i].questions[j].imageLink);var k=e.getXml(a.saveFile);if(!k)return void alert("ERROR no save data found, or save data was unreadable");var l=k.getElementsByTagName("case")[0].getAttribute("caseStatus");if(l>0){for(var m in a.submitted)if(a.submitted.hasOwnProperty(m)){m=m.substr(m.lastIndexOf("/")+1);var n=m.indexOf("-"),o=m.indexOf("-",n+1),p=m.indexOf("-",o+1);g[Number(m.substr(0,n))].questions[Number(m.substr(n+1,o-n-1))].files[Number(m.substr(o+1,p-o-1))]=m.substr(m.indexOfAt("-",3)+1)}f.assignQuestionStates(g,k.getElementsByTagName("question"))}else l=1;return{categories:g,category:l-1,resources:d,images:h}},g.prepareZip=function(a){JSZip.support.blob&&(a.onclick=d)},g.removeFilesFor=function(a,b){var c=b.board+"-"+b.question+"-";for(var d in a.submitted)a.submitted.hasOwnProperty(d)&&d.startsWith(c)&&delete a.submitted[d]},g.addNewFilesToSystem=function(a,b,c){for(var d=1,e=0,f=function(){++e>=d&&c(a)},g=0;g<b.files.length;g++)!function(){var c=new FileReader,e=b.board+"-"+b.question+"-"+g+"-"+b.files[g].name;d++,c.onload=function(b){a.submitted[e]=b.target.result,f()},c.readAsDataURL(b.files[g])}();f()}},{"../case/category.js":2,"../case/resources.js":4,"./iparDataParser.js":11,"./utilities.js":15}],11:[function(a,b,c){"use strict";var d=a("../case/category.js"),e=a("../case/resources.js"),f=a("./utilities.js"),g=a("../game/constants.js"),h=a("../case/question.js"),i={hidden:h.SOLVE_STATE.HIDDEN,unsolved:h.SOLVE_STATE.UNSOLVED,correct:h.SOLVE_STATE.SOLVED},j=["hidden","unsolved","correct"],k="unassigned",l="unassigned",m="email",n=b.exports;n.assignQuestionStates=function(a,b){for(var c=0,d=0;d<a.length;d++)for(var e=0;e<a[d].questions.length;e++,c++){var j=a[d].questions[e],k=b[c];j.currentState=i[k.getAttribute("questionState")],j.justification&&(j.justification.value=k.getAttribute("justification")),j.currentState==h.SOLVE_STATE.SOLVED&&j.correctAnswer(),j.positionPercentX=f.map(parseInt(k.getAttribute("positionPercentX")),0,100,0,g.boardSize.x),j.positionPercentY=f.map(parseInt(k.getAttribute("positionPercentY")),0,100,0,g.boardSize.y)}},n.getResources=function(a){var b=a.getElementsByTagName("resourceList")[0].getElementsByTagName("resource");return new e(b,a)},n.getCategoriesAndQuestions=function(a,b,c){if(null!=a){k=a.getElementsByTagName("case")[0].getAttribute("profileFirst"),l=a.getElementsByTagName("case")[0].getAttribute("profileLast"),a.getElementsByTagName("case")[0].getAttribute("profileMail");for(var e=a.getElementsByTagName("category"),f=a.getElementsByTagName("categoryList")[0].getElementsByTagName("element"),g=[],h=0;h<e.length;h++)g[parseInt(e[h].getAttribute("categoryDesignation"))]=new d(f[h].innerHTML,e[h],b,c);return g}return null},n.recreateCaseFile=function(a){var b=n.createXMLSaveFile(a,!0);return b},n.createXMLSaveFile=function(a,b,c){var d;d=c?"\n":"";var e='<?xml version="1.0" encoding="utf-8"?>'+d;e+='<case categoryIndex="3" caseStatus="'+(a+1)+'" profileFirst="'+k+'" profileLast="'+l+'" profileMail="'+m+'">'+d,e+="<questions>"+d;for(var h=0;h<b.length;h++)for(var i=0;i<b[h].lessonNodeArray.length;i++){var n=b[h].lessonNodeArray[i].question;e+="<question ",e+='questionState="'+j[n.currentState]+'" ';var o,p=n.justification.value;o=p?p:n.justificationString,o||(o=""),e+='justification="'+o+'" ',e+='animated="'+(2==n.currentState)+'" ',e+='linesTraced="0" ',e+='revealThreshold  ="'+n.revealThreshold+'" ',e+='positionPercentX="'+f.map(n.positionPercentX,0,g.boardSize.x,0,100)+'" ',e+='positionPercentY="'+f.map(n.positionPercentY,0,g.boardSize.y,0,100)+'" ',e+="/>"+d}return e+="</questions>"+d,e+="</case>"+d}},{"../case/category.js":2,"../case/question.js":3,"../case/resources.js":4,"../game/constants.js":6,"./utilities.js":15}],12:[function(a,b,c){"use strict";function d(a){this.key=[],this.preKey=[],this.keyPressed=[],this.keyReleased=[];var b=this;window.addEventListener("keydown",function(c){a.active&&c.preventDefault(),b.key[c.keyCode]=!0}),window.addEventListener("keyup",function(c){a.active&&c.preventDefault(),b.key[c.keyCode]=!1})}var e=d.prototype;e.update=function(){for(var a=0;a<this.keyPressed.length;a++)this.keyPressed[a]&&(this.keyPressed[a]=!1);for(var a=0;a<this.keyReleased.length;a++)this.keyReleased[a]&&(this.keyReleased[a]=!1);for(var a=0;a<this.key.length;a++)this.preKey[a]&&!this.key[a]&&(this.keyReleased[a]=!0),!this.preKey[a]&&this.key[a]&&(this.keyPressed[a]=!0),this.preKey[a]=this.key[a]},b.exports=d},{}],13:[function(a,b,c){"use strict";function d(){this.mousePosition=new m(0,0),e=new m(0,0),this.virtualPosition=new m(0,0),this.mouseDown=!1,this.mouseIn=!1,f=0,i=0,this.mouseWheelDY=0,this.zoomDiff=0,k=0,this.mouseClicked=!1,g=!1,h=200}var e,f,g,h,i,j,k,l,m=a("./point.js"),n=d.prototype;n.addCanvas=function(a){var b=this;a.addEventListener("mousemove",function(a){a.preventDefault(),b.updatePosition(a)}),a.addEventListener("touchmove",function(a){a.preventDefault(),j?b.updateTouchPositions(a):b.updatePosition(a.touches[0])}),a.addEventListener("mousedown",function(a){a.preventDefault(),(a.which&&3!=a.which||a.button&&2!=a.button)&&(b.mouseDown=!0)}),a.addEventListener("contextmenu",function(a){g=!0}),a.addEventListener("touchstart",function(a){a.preventDefault(),1!=a.touches.length||j?2==a.touches.length&&(b.mouseDown=!1,j=!0,b.updateTouchPositions(a),l=k):(b.updatePosition(a.touches[0]),setTimeout(function(){b.mouseDown=!0}))}),a.addEventListener("mouseup",function(a){a.preventDefault(),(a.which&&3!=a.which||a.button&&2!=a.button)&&(b.mouseDown=!1)}),a.addEventListener("touchend",function(a){a.preventDefault(),j&&(j=!1,k=0,l=0),b.mouseDown=!1}),a.addEventListener("mouseover",function(a){b.mouseIn=!0}),a.addEventListener("mouseout",function(a){b.mouseIn=!1,b.mouseDown=!1}),a.addEventListener("mousewheel",function(a){a.preventDefault(),i+=a.deltaY},!1)},n.updatePosition=function(a){this.mousePosition=new m(a.clientX,a.clientY),e=new m(this.mousePosition.x-window.innerWidth/2,this.mousePosition.y-window.innerHeight/2)},n.updateTouchPositions=function(a){var b=[new m(a.touches[0].clientX,a.touches[0].clientY),new m(a.touches[1].clientX,a.touches[1].clientY)];k=Math.sqrt(Math.pow(b[0].x-b[1].x,2)+Math.pow(b[0].y-b[1].y,2))},n.update=function(a,b){this.virtualPosition=new m(e.x/b,e.y/b),this.mouseWheelDY=i,i=0,j?this.zoomDiff=l-k:this.zoomDiff=0,this.mouseClicked=!1,this.mouseDown?f+=a:(f>0&&h>f&&(this.mouseClicked=!0),f=0),this.prevMouseDown=this.mouseDown,this.hasTarget=!1},n.leftMouseClicked=function(){var a=g;return g=!1,a},b.exports=d},{"./point.js":14}],14:[function(a,b,c){"use strict";function d(a,b){this.x=a,this.y=b}var e=d.prototype;e.add=function(a,b){return b?new d(this.x+a,this.y+b):new d(this.x+a.x,this.y+a.y)},e.mult=function(a,b){return b?new d(this.x*a,this.y*b):new d(this.x*a.x,this.y*a.y)},e.scale=function(a){return new d(this.x*a,this.y*a)},b.exports=d},{}],15:[function(a,b,c){"use strict";var d=a("./point.js"),e=b.exports;e.getMouse=function(a){return new d(a.pageX-a.target.offsetLeft,a.pageY-a.target.offsetTop)},e.map=function(a,b,c,d,e){return d+(e-d)*((a-b)/(c-b))},e.clamp=function(a,b,c){return Math.max(b,Math.min(c,a))},e.mouseIntersect=function(a,b,c){return a.virtualPosition.x>b.position.x-b.width/2-c.x&&a.virtualPosition.x<b.position.x+b.width/2-c.x&&a.virtualPosition.y>b.position.y-b.height/2-c.y&&a.virtualPosition.y<b.position.y+b.height/2-c.y},e.mouseIntersectEdge=function(a,b,c,d){var e={left:b.position.x-b.width/2-d.x,right:b.position.x+b.width/2-d.x,top:b.position.y-b.height/2-d.y,bottom:b.position.y+b.height/2-d.y};if(a.virtualPosition.x>e.left-c&&a.virtualPosition.x<e.right+c&&a.virtualPosition.y>e.top-c&&a.virtualPosition.y<e.bottom+c){var f="";if(a.virtualPosition.y<=e.top&&(f+="n"),a.virtualPosition.y>=e.bottom&&(f+="s"),a.virtualPosition.x<=e.left&&(f+="w"),a.virtualPosition.x>=e.right&&(f+="e"),1!=f)return f}return null},e.getXml=function(a){for(a=a.trim();a.charCodeAt(0)<=32;)a=a.substr(1);a=a.trim();var b;if(window.DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml")}else b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a);return b},e.getScale=function(a,b){return b.y/a.x*a.y<b.x?b.y/a.y:b.x/a.x},e.replaceAll=function(a,b,c){for(;a.indexOf(b)>-1;)a=a.replace(b,c);return a},String.prototype.indexOfAt=function(a,b){for(var c=0,d=0;b>d&&-1!=c;d++)c=this.indexOf(a,c+1);return c}},{"./point.js":14}],16:[function(a,b,c){var d=b.exports;d.editInfo='<div class="window popup">	<div class="title">		Case Info	</div>	<div class="windowContent" style="min-height:35vh;">		<form onsubmit="return false;">			<b>Name</b><br>			<input name="caseName" value="%caseName%"><br>			<b>Description</b><br>		 	<p><div class="text-box large" contenteditable>%description%</div></p>			<b>Conclusion</b><br>	 		<p><div class="text-box large" contenteditable>%conclusion%</div></p>			<button class="halfButton">Back</button><button class="halfButton">Apply Changes</button>		</form>	</div></div>',d.resourcesWindow='<div class="window popup">	<div class="title">		Resources	</div>	<div class="windowContent">		<div class="resourceContent" style="overflow-y:scroll;height:35vh;">		</div>		<br>		<button class="halfButton">Back</button><button class="halfButton">Create New Resources</button>	</div></div>',d.resource='<div class="resourceItem">  <img src="%icon%" class="icon"/>  <img src="../img/iconClose.png" class="delete"/>  <img src="../img/iconTools.png" class="edit"/>  <div class="resourceText">%title%  <br>  <span style="color:gray;">%link%</span></div></div>',d.resourceEditor='<div class="window popup">	<div class="title">		%edit% Resource	</div>	<div class="windowContent">		<form onsubmit="return false;">			<select name="type" class="full">				<option value="0">File Refrence</option>				<option value="1">Web Link</option>				<option value="2">Video Link</option>			</select>			<b>Display Name</b><br>			<input name="name" value="%name%"><br>			<b class="addressTag">Link Address</b><br>			<input class="address" name="link" value="%link%">			<button class="halfButton">Choose File</button><button class="halfButton">View File</button>			<span class="addressInfo"></span>		</form>		<br>		<button class="halfButton">Cancel</button><button class="halfButton">%apply%</button>	</div></div>',d.textInput='<div class="window popup">	<div class="title">		%title%	</div>	<div class="windowContent">		<form onsubmit="return false;">			<b>%prompt%</b><br>			<input name="text" value="%value%"><br>		</form>		<br>		<button class="halfButton">Cancel</button><button class="halfButton">%apply%</button>	</div></div>',d.imagesEditor='<div class="window images">	<div class="title">		Images	</div>	<div class="windowContent">		<div class="imageContent">		</div>		<br>		<input type="file" style="display:none;"/>		<button class="thirdButton">Close</button><button class="thirdButton">Upload Image</button><button class="thirdButton">Import Image</button>	</div></div>',d.image='<div class="image">	<img src=%image% />	<img src="../img/iconClose.png" class="delete"/></div>'},{}],17:[function(a,b,c){var d=b.exports;d.taskWindow='<div class="window">	<div class="title">		Task	</div>	<div class="windowContent" style="overflow-y: scroll;height:30vh;">		<h3><b>Question Name</b></h3>		<h3><b><div class="text-box" contenteditable>%title%</div></b></h3><br>		<p>Instructions</p>		<p><div class="text-box large" contenteditable>%instructions%</div></p>		<hr>		<p><b>Question</b></p>		<p><b><div class="text-box large" contenteditable>%question%</div></b></p>	</div></div>',d.resourceWindow='<div class="window">	<div class="title">		Resource	</div>	<div class="windowContent" style="overflow-y: scroll; height:20vh;">		<div class="resourceContent">		</div>		<br>		<button class="full">Add Resource</button>	</div></div>',
d.resource='<div class="resourceItem">  <img src="%icon%" class="icon"/>  <img src="../img/iconClose.png" class="delete"/>  <div class="resourceText">%title%</div>  <a href="%link%" target="_blank">    <div class="center">      Open      <img src="../img/iconLaunch.png"/>    </div>  </a></div>',d.answerWindow='<div class="window right">	<div class="title">		Answers	</div>	<div class="windowContent" style="min-height:20vh;">		<select>			<option value="2">2</option>			<option value="3">3</option>			<option value="4">4</option>			<option value="5">5</option>		</select>		answers. Select correct answer with radio button.		<form onsubmit="return false;">				</form>	</div></div>',d.answer='<input type="radio" name="answer" value="%num%" class="answerRadio"><div class="answerInputs">	<b>Choice %num%</b><br>	<input name="answer%num%" value="%answer%"><br>	Feedback<br>	<input name="feedback%num%" value="%feedback%"><br></div>',d.messageWindow='<div class="window">	<div class="title">		Message	</div>	<div class="windowContent" style="height:60vh;overflow-y:scroll;">		<p><b>From </b>		<div class="text-box" contenteditable>%title%</div></p>		<hr>		<p><b>Subject </b>		<div class="text-box" contenteditable>%instructions%</div></p>		<hr>		<p>Message</p>		<p><div class="text-box tall" contenteditable>%question%</div></p>	</div></div>',d.questionTypeWindow='<div class="window">	<div class="title">		Question Type	</div>	<div class="windowContent">		<select class="full">			<option value="1">Justification Multiple Choice</option>			<option value="2">Standard Multiple Choice</option>			<option value="3">Short Response</option>			<option value="4">File Submisson</option>			<option value="5">Message</option>		</select>		<button class="imageButton">		  <div><img src="../img/placeholder.png"/></div>		  <div> Select Image </div>		</button>	</div>	<div class="windowButtons">		<button>Save</button>	</div></div>'},{}],18:[function(a,b,c){function d(a){e=a,k=m.NONE,f=document.querySelector("#"+e.id+" #input-name"),g=document.querySelector("#"+e.id+" #input-description"),conclusionInput=document.querySelector("#"+e.id+" #input-conclusion"),h=document.querySelector("#"+e.id+" #input-cat1"),i=document.querySelector("#"+e.id+" #create-button"),j=document.querySelector("#"+e.id+" #back-button"),j.onclick=function(){b.next=m.TITLE,b.close()};var b=this;i.onclick=function(){b.next=m.BOARD,i.disabled=!0,j.disabled=!0;var a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var c=new Worker("../lib/unzip.js");c.onmessage=function(a){var c=a.data,d=l.getXml(c.caseFile),e=d.getElementsByTagName("case")[0];e.setAttribute("caseName",f.value),e.setAttribute("description",g.innerHTML),e.setAttribute("conclusion",conclusionInput.innerHTML);var i=e.getElementsByTagName("categoryList")[0];i.setAttribute("categoryCount","1"),i.innerHTML="<element>"+h.value+"</element>";var j=d.createElement("category");j.setAttribute("categoryDesignation","0"),j.setAttribute("questionCount","0"),e.appendChild(j),localStorage.caseName=f.value+".ipar",c.caseFile=(new XMLSerializer).serializeToString(d),localStorage.caseDataCreate=JSON.stringify(c),b.close()},c.postMessage(a.response)}},a.open("GET","base.ipar",!0),a.send()}}var e,f,g,h,i,j,k,l=a("../helper/utilities.js"),m=Object.freeze({NONE:0,TITLE:1,BOARD:2}),n=d.prototype;n.open=function(){e.style.display="";var a=function(){""==f.value||""==h.value?i.disabled=!0:i.disabled=!1};f.addEventListener("change",a),h.addEventListener("change",a),a()},n.close=function(){e.style.display="none",this.onclose&&this.onclose()},b.exports=d,b.exports.NEXT=m},{"../helper/utilities.js":15}],19:[function(a,b,c){var d=a("../html/popupWindows.js"),e=b.exports;e.editInfo=function(a,b,c){var e=document.createElement("DIV");e.innerHTML=d.editInfo;var f=e.firstChild,g=b.getElementsByTagName("case")[0];f.innerHTML=f.innerHTML.replace(/%caseName%/g,g.getAttribute("caseName")).replace(/%description%/g,g.getAttribute("description")).replace(/%conclusion%/g,g.getAttribute("conclusion"));var h=f.getElementsByTagName("button");h[0].onclick=function(){a.innerHTML="",c(b,g.getAttribute("caseName"))},h[1].onclick=function(){a.innerHTML="";var d=f.getElementsByTagName("form")[0],e=d.getElementsByTagName("div");g.setAttribute("caseName",d.elements.caseName.value),g.setAttribute("description",e[0].innerHTML),g.setAttribute("conclusion",e[1].innerHTML),c(b,d.elements.caseName.value)},a.innerHTML="",a.appendChild(f)},e.prompt=function(a,b,c,e,f,g){var h=document.createElement("DIV");h.innerHTML=d.textInput;var i=h.firstChild;i.innerHTML=i.innerHTML.replace(/%title%/g,b).replace(/%prompt%/g,c).replace(/%value%/g,e).replace(/%apply%/g,f);var j=i.getElementsByTagName("button");j[0].onclick=function(){a.innerHTML="",g()},j[1].onclick=function(){a.innerHTML="",g(i.getElementsByTagName("form")[0].elements.text.value)},a.innerHTML="",a.appendChild(i)}},{"../html/popupWindows.js":16}],20:[function(a,b,c){function d(a){e=a,k=l.NONE,f=document.querySelector("#"+e.id+" #load-input"),g=document.querySelector("#"+e.id+" #load-button"),h=document.querySelector("#"+e.id+" #create-button"),i=document.querySelector("#"+e.id+" #continue-button"),j=document.querySelector("#"+e.id+" #menu-button"),h.onclick=this.create.bind(this),g.onclick=function(){localStorage.caseDataCreate&&!confirm("Are you sure you want to start a new case? Your autosave data will be lost!")||f.click()},f.onchange=this.loadFile.bind(this),i.onclick=this.close.bind(this),j.onclick=function(){window.location.href="../index.html"}}var e,f,g,h,i,j,k,l=Object.freeze({NONE:0,BOARD:1,CREATE:2}),m=d.prototype;m.open=function(){e.style.display="",localStorage.caseDataCreate?i.disabled=!1:i.disabled=!0,this.next=l.BOARD,g.disabled=!1,f.disabled=!1,j.disabled=!1,h.disabled=!1},m.create=function(){localStorage.caseDataCreate&&!confirm("Are you sure you want to start a new case? Your autosave data will be lost!")||(this.next=l.CREATE,this.close())},m.loadFile=function(a){if(!f.value.endsWith("ipar"))return void alert("You didn't choose an ipar file! you can only load ipar files!");localStorage.caseName=a.target.files[0].name,g.disabled=!0,f.disabled=!0,j.disabled=!0,h.disabled=!0,i.disabled=!0;var b=this,c=new FileReader;c.onload=function(a){localStorage.setItem("autosave","");var c=new Worker("lib/unzip.js");c.onmessage=function(a){localStorage.caseDataCreate=JSON.stringify(a.data),b.next=l.BOARD,b.close()},c.postMessage(a.target.result)},c.readAsArrayBuffer(a.target.files[0])},m.close=function(){e.style.display="none",this.onclose&&this.onclose()},b.exports=d,b.exports.NEXT=l},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]);